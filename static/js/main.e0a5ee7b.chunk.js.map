{"version":3,"sources":["layouts/FullscreenPageLayout.tsx","components/Navbar.tsx","components/Footer.tsx","layouts/PanelLayout.tsx","actions/editor.ts","editor-tools/Tool.ts","models/svg.ts","editor-tools/Select.tsx","editor-tools/index.tsx","selectors/palette.ts","components/SvgShapeRenderer.tsx","editor-tools/Line.tsx","editor-tools/Polyline.tsx","editor-tools/Circle.tsx","editor-tools/Polygon.tsx","selectors/editor.ts","actions/tiles.ts","reducers/tiles.ts","components/SvgToolbar.tsx","components/controls/IntegerControl.tsx","components/controls/FloatControl.tsx","components/controls/PointControl.tsx","reducers/palette.ts","components/controls/PalettePickerControl.tsx","actions/palette.ts","components/Scrollable.tsx","components/SvgPropertyEditor.tsx","components/SvgCanvas.tsx","components/SvgGrid.tsx","selectors/tiles.ts","components/SvgEditorCanvas.tsx","utils.ts","components/SvgElementViewer.tsx","components/SvgEditor.tsx","pages/TileEditor/index.tsx","pages/Generator/index.tsx","pages/Tiles/TileItem.tsx","pages/Tiles/index.tsx","pages/Tiles/Reorder.tsx","App.tsx","reportWebVitals.ts","reducers/editor.ts","reducers/index.ts","index.tsx"],"names":["FullscreenPageLayout","props","className","header","children","footer","Navbar","role","aria-label","to","Footer","blk","bem","PanelLayout","horizontal","vertical","left","right","EDITOR_ADD_SHAPE","EDITOR_SET_GRID","EDITOR_SELECT_SHAPE","EDITOR_SELECT_TOOL","EDITOR_ELEM_PROP_CHANGE","EDITOR_SET_ELEMENTS","EDITOR_DELETE_ELEMENT","EDITOR_CLEAR","addShape","shape","type","selectShape","idx","selectTool","tool","setElements","elements","ToolType","SvgShapeType","PropertyType","Tool","state","dispatch","e","CREATOR","Select","MANIPULATOR","Tools","nextShapeId","lastId","WithStrokeProperties","strokeWidth","label","FLOAT","strokeColorId","COLOR","WithFillProperties","fillColorId","SvgCircleProperties","center","POINT","required","r","SvgLineProperties","point1","point12","SvgPolygonProperties","SvgPolylineProperties","propertiesMap","TYPE_LINE","TYPE_POLYGON","TYPE_POLYLINE","TYPE_CIRCLE","colorSelector","id","undefined","palette","paletteSelector","selectedColor","SvgLineRenderer","line","selected","color","useSelector","actualColor","x1","x","y1","y","x2","point2","y2","stroke","eventHandlers","SvgPolylineRenderer","polyline","points","map","p","join","fill","SvgCircleRenderer","circle","strokeColor","cx","cy","SvgPolygonRenderer","polygon","SvgShapeRenderer","Line","this","getInitialState","zIndex","Polyline","concat","pop","push","Circle","getDistance","p1","p2","dx","dy","Math","sqrt","Polygon","length","onFinish","toolMap","SELECT","LINE","POLYLINE","CIRCLE","POLYGON","gridSizeSelector","editor","gridSize","elementsSelector","toolSelector","selectedTool","selectedIdxSelector","selectedIdx","TILES_SET_TILE","TILES_DELETE_TILE","TILES_SET_TILES","nextTileId","initialState","SvgToolbar","useDispatch","history","useHistory","params","useParams","parseInt","handleSave","useCallback","tile","onClick","IntegerControl","useState","initialValue","value","setValue","onChange","val","target","i","FloatControl","parseFloat","isNaN","step","PointControl","prop","name","newVal","defaultColor","0","nextId","NoColorSvg","viewBox","preserveAspectRatio","PickerItem","React","forwardRef","ref","canEdit","onDelete","onSelect","editOpen","setEditOpen","openEdit","closeEdit","handleEdit","updateColor","hex","style","backgroundColor","onChangeComplete","PalettePickerControl","ids","Object","keys","k","selectedRef","useRef","handleSelection","handleDelete","removeColor","handleAddColor","useEffect","current","scrollIntoView","Scrollable","PropertyInput","changeHandler","elemIdx","propName","elemPropChange","shapeIdx","ResolveControl","property","INTEGER","PropertiesEditor","propertyTypes","properties","SvgPropertyEditor","SvgCanvas","svgRef","overlay","SvgGrid","gridLinesCount","grid","lines","Array","_","strokeOpacity","vectorEffect","tilesSelector","tiles","SvgEditorCanvas","svg","setSvgRef","svgPoint","setSvgPoint","el","createSVGPoint","clientX","clientY","transformed","matrixTransform","getScreenCTM","inverse","round","useSvgUtils","eventToSvgCoords","hoverPoint","setHoverPoint","setSelectedTool","toolState","setToolState","onMouseMove","onMouseLeave","onShapeClick","svgEventHandlers","renderedShape","renderShape","showHoverPoint","toolType","useTool","find","t","tileSelector","handleClick","point","handleMouseMove","handleMouseExit","handleShapeClick","stopPropagation","handleContextMenu","preventDefault","onContextMenu","reorder","list","startIndex","endIndex","result","from","splice","removed","shapeToLabel","SvgElementViewer","handleSelect","handleDragEnd","destination","source","index","deleteElement","handleDeselect","elementsReversed","reverse","onDragEnd","droppableId","provided","snapshot","droppableProps","innerRef","draggableId","toString","innerProvided","draggableProps","dragHandleProps","placeholder","SvgEditor","TileEditor","Generator","NewTileItem","TileItem","Tiles","handleAddNew","Reorder","setTiles","App","basename","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","rootReducer","combineReducers","action","newSelected","size","s","newSelectedIdx","findIndex","filter","newState","tileIdx","store","createStore","composeWithDevTools","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"uOAwBeA,EAhBc,SAACC,GAC1B,OACI,sBAAKC,UAAU,oBAAf,UACI,qBAAKA,UAAU,4BAAf,SACMD,EAAME,SAEZ,qBAAKD,UAAU,6BAAf,SACMD,EAAMG,WAEZ,qBAAKF,UAAU,4BAAf,SACMD,EAAMI,aCUTC,EAzBA,WACX,OACI,sBAAKJ,UAAU,iBAAiBK,KAAK,aAAaC,aAAW,kBAA7D,UACI,qBAAKN,UAAU,eAAf,SACI,qBAAIA,UAAU,uCAAd,UACI,sBAAMA,UAAU,iCAAhB,yBACA,sBAAMA,UAAU,oDAAhB,4BAIR,qBAAKA,UAAU,cAAf,SACI,sBAAKA,UAAU,eAAf,UACI,cAAC,IAAD,CAAMO,GAAG,IAAIP,UAAU,cAAvB,uBAIA,cAAC,IAAD,CAAMO,GAAG,SAASP,UAAU,cAA5B,4BCJLQ,EAbA,WACX,OACI,wBAAQR,UAAU,2BAAlB,SACI,qBAAKA,UAAU,4BAAf,SACI,oBAAGA,UAAU,gBAAb,UACI,sDADJ,6G,OCIVS,EAAMC,YAAI,gBAmBDC,EAjBK,SAACZ,GACjB,IAAMa,EAAab,EAAMa,WACzB,OACI,sBAAKZ,UAAWS,EAAI,CAACG,aAAYC,UAAWD,IAA5C,UACI,qBAAKZ,UAAWS,EAAI,QAApB,SACMV,EAAMe,OAEZ,qBAAKd,UAAWS,EAAI,WAApB,SACMV,EAAMG,WAEZ,qBAAKF,UAAWS,EAAI,QAApB,SACMV,EAAMgB,Y,OCnBXC,EAAmB,mBACnBC,EAAkB,kBAClBC,EAAsB,sBACtBC,EAAqB,qBACrBC,EAA0B,0BAC1BC,EAAsB,sBACtBC,EAAwB,wBACxBC,EAAe,eAMrB,SAASC,EAASC,GACrB,MAAO,CACHC,KAAMV,EACNS,SAmBD,SAASE,EAAYC,GACxB,MAAO,CACHF,KAAMR,EACNU,OAQD,SAASC,EAAWC,GACvB,MAAO,CACHJ,KAAMP,EACNW,QAuBD,SAASC,EAAYC,GACxB,MAAO,CACHN,KAAML,EACNW,Y,IC3EIC,E,0DAAAA,O,qBAAAA,I,8BAAAA,M,WCJAC,EAYAC,EDHkBC,E,gGACXC,EAAUC,EAAoBC,GACzC,OAAOF,I,kCAGQA,EAAUC,EAAoBC,GAC7C,OAAOF,I,mCAGSA,EAAUC,EAAoBC,GAC9C,OAAOF,I,mCAGSA,EAAUC,EAAoBV,EAAaH,GAC3D,OAAOY,I,+BAGKA,EAAUC,GACtB,OAAOD,I,kCAGQA,GACf,OAAO,O,iCAIP,OAAOJ,EAASO,U,uCAIhB,OAAO,M,KE9BMC,E,sKACTJ,EAAoBC,EAAoBC,GAE5C,OADAD,EAASX,EAAY,OACdU,I,mCAGEA,EAAoBC,EAAoBV,EAAaH,GAE9D,OADAa,EAASX,EAAYC,IACdS,I,uCAIP,OAAO,I,iCAIP,OAAOJ,EAASS,c,wCAIhB,MAAO,O,GApBqBN,G,iBDTxBF,K,qBAAAA,E,iBAAAA,E,uBAAAA,E,0BAAAA,M,cAYAC,O,qBAAAA,I,iBAAAA,I,iBAAAA,I,kBAAAA,M,KAeL,I,EEjBKQ,EFiBCC,EAAe,WACxB,IAAIC,EAAS,EACb,OAAO,mBAAQA,GAFS,GAgBtBC,EAAmC,CACrCC,YAAa,CACTC,MAAO,eACPtB,KAAMS,EAAac,OAEvBC,cAAe,CACXF,MAAO,eACPtB,KAAMS,EAAagB,QAQrBC,EAAiC,CACnCC,YAAa,CACTL,MAAO,aACPtB,KAAMS,EAAagB,QASdG,EAA+B,yBACxCC,OAAQ,CACJP,MAAO,SACPtB,KAAMS,EAAaqB,MACnBC,UAAU,GAEdC,EAAG,CACCV,MAAO,SACPtB,KAAMS,EAAac,MACnBQ,UAAU,IAEXL,GACAN,GAQMa,EAA6B,aACtCC,OAAQ,CACJZ,MAAO,cACPtB,KAAMS,EAAaqB,MACnBC,UAAU,GAEdI,QAAS,CACLb,MAAO,YACPtB,KAAMS,EAAaqB,MACnBC,UAAU,IAEXX,GAOMgB,EAAgC,2BACtChB,GACAM,GAOMW,EAAoCjB,EAEpCkB,GAAa,mBACrB9B,EAAa+B,UAAYN,GADJ,cAErBzB,EAAagC,aAAeJ,GAFP,cAGrB5B,EAAaiC,cAAgBJ,GAHR,cAIrB7B,EAAakC,YAAcd,GAJN,GGpHbe,EAAgB,SAACC,GAAD,OAAuB,SAACjC,GAAD,OAA4B,OAAPiC,OAAcC,EAAYlC,EAAMmC,QAAQF,KACpGG,EAAkB,SAACpC,GAAD,OAAmCA,EAAMmC,SCMlEE,GAAgB,UAEhBC,GAAkB,SAAC5E,GAA4C,IAAD,EACzD6E,EAAkB7E,EAAlB6E,KAAMC,EAAY9E,EAAZ8E,SAEPC,EAAQC,YAAYV,EAAcO,EAAK1B,gBACvC8B,EAAcH,EAAWH,GAAgBI,EAC/C,OAAO,kCACHG,GAAIL,EAAKhB,OAAOsB,EAChBC,GAAIP,EAAKhB,OAAOwB,EAChBC,GAAIT,EAAKU,OAAOJ,EAChBK,GAAIX,EAAKU,OAAOF,EAChBI,OAAM,OAAER,QAAF,IAAEA,IAAe,OACvBjC,YAAW,UAAE6B,EAAK7B,mBAAP,QAAsB,GAC7BhD,EAAM0F,iBAGZC,GAAsB,SAAC3F,GAAoD,IAAD,EACrE4F,EAAsB5F,EAAtB4F,SAAUd,EAAY9E,EAAZ8E,SAEXC,EAAQC,YAAYV,EAAcsB,EAASzC,gBAC3C8B,EAAcH,EAAWH,GAAgBI,EAC/C,OAAO,sCACHc,OAAQD,EAASC,OAAOC,KAAI,SAAAC,GAAC,gBAAOA,EAAEZ,EAAT,YAAcY,EAAEV,MAAKW,KAAK,KACvDP,OAAM,OAAER,QAAF,IAAEA,IAAe,OACvBjC,YAAW,UAAE4C,EAAS5C,mBAAX,QAA0B,EACrCiD,KAAK,QACDjG,EAAM0F,iBAGZQ,GAAoB,SAAClG,GAAgD,IAAD,EAC/DmG,EAAoBnG,EAApBmG,OAAQrB,EAAY9E,EAAZ8E,SAETC,EAAQC,YAAYV,EAAc6B,EAAO7C,cACzC2B,EAAcH,EAAWH,GAAgBI,EAEzCqB,EAAcpB,YAAYV,EAAc6B,EAAOhD,gBAErD,OAAO,oCACHkD,GAAIF,EAAO3C,OAAO2B,EAClBmB,GAAIH,EAAO3C,OAAO6B,EAClB1B,EAAGwC,EAAOxC,EACVsC,KAAI,OAAEhB,QAAF,IAAEA,IAAe,OACrBQ,OAAM,OAAEW,QAAF,IAAEA,IAAe,OACvBpD,YAAW,UAAEmD,EAAOnD,mBAAT,QAAwB,GAC/BhD,EAAM0F,iBAGZa,GAAqB,SAACvG,GAAkD,IAAD,EAClEwG,EAAqBxG,EAArBwG,QAAS1B,EAAY9E,EAAZ8E,SAEVC,EAAQC,YAAYV,EAAckC,EAAQlD,cAC1C2B,EAAcH,EAAWH,GAAgBI,EAEzCqB,EAAcpB,YAAYV,EAAckC,EAAQrD,gBAEtD,OAAO,qCACH0C,OAAQW,EAAQX,OAAOC,KAAI,SAAAC,GAAC,gBAAOA,EAAEZ,EAAT,YAAcY,EAAEV,MAAKW,KAAK,KACtDC,KAAI,OAAEhB,QAAF,IAAEA,IAAe,OACrBQ,OAAM,OAAEW,QAAF,IAAEA,IAAe,OACvBpD,YAAW,UAAEwD,EAAQxD,mBAAV,QAAyB,GAChChD,EAAM0F,iBAoBHe,GAjBU,SAACzG,GACtB,IAAM0B,EAAQ1B,EAAM0B,MAEpB,OAAQA,EAAMC,MACV,KAAKQ,EAAa+B,UACd,OAAO,cAAC,GAAD,CAAiBW,KAAMnD,EAAkBgE,cAAe1F,EAAM0F,cAAeZ,SAAU9E,EAAM8E,WACxG,KAAK3C,EAAaiC,cACd,OAAO,cAAC,GAAD,CAAqBwB,SAAUlE,EAAsBgE,cAAe1F,EAAM0F,cAAeZ,SAAU9E,EAAM8E,WACpH,KAAK3C,EAAakC,YACd,OAAO,cAAC,GAAD,CAAmB8B,OAAQzE,EAAoBgE,cAAe1F,EAAM0F,cAAeZ,SAAU9E,EAAM8E,WAC9G,KAAK3C,EAAagC,aACd,OAAO,cAAC,GAAD,CAAoBqC,QAAS9E,EAAqBgE,cAAe1F,EAAM0F,cAAeZ,SAAU9E,EAAM8E,WACjH,QACI,OAAO,OC9EE4B,G,sKACTpE,EAAkBC,EAAoBC,GAC1C,OAAIF,EAAMuB,QACNtB,EAASd,EAAS,2BAAIa,GAAL,IAAYiC,GAAI1B,QAC1B8D,KAAKC,mBAET,2BAAItE,GAAX,IAAkBuB,OAAQrB,M,kCAGlBF,EAAkBC,EAAoBC,GAC9C,OAAIF,EAAMuB,OACC,2BAAIvB,GAAX,IAAkBiD,OAAQ/C,IACvBF,I,kCAGCA,GACR,OAAIA,EAAMuB,QAAUvB,EAAMiD,OACf,cAAC,GAAD,CAAkB7D,MAAOY,IAE7B,O,wCAIP,MAAO,CACHX,KAAMQ,EAAa+B,UACnB2C,OAAQ,EACR1D,cAAe,EACfH,YAAa,O,GA3BSX,G,SCAbyE,G,sKAETxE,EAAsBC,EAAoBC,GAC9C,OAAO,2BAAIF,GAAX,IAAkBuD,OAAQvD,EAAMuD,OAAOkB,OAAOvE,O,kCAGtCF,EAAsBC,EAAoBC,GAClD,IAAMqD,EAAM,aAAOvD,EAAMuD,QAGzB,OAFAA,EAAOmB,MACPnB,EAAOoB,KAAKzE,GACL,2BAAIF,GAAX,IAAkBuD,a,+BAGbvD,EAAsBC,GAC3B,IAAMsD,EAAM,aAAOvD,EAAMuD,QAKzB,OAJAA,EAAOmB,MAEPzE,EAASd,EADE,2BAAOa,GAAP,IAAcuD,SAAQtB,GAAI1B,QAG9B8D,KAAKC,oB,kCAGJtE,GACR,OAAO,cAAC,GAAD,CAAkBZ,MAAOY,M,wCAIhC,MAAO,CACHX,KAAMQ,EAAaiC,cACnByC,OAAQ,EACR1D,cAAe,EACfH,YAAa,EACb6C,OAAQ,GACRtB,GAAI,O,GAjCsBlC,GCAjB6E,G,sKACT5E,EAAoBC,EAAoBC,GAC5C,OAAIF,EAAMkB,QACNjB,EAASd,EAAS,2BAAIa,GAAL,IAAYiC,GAAI1B,QAC1B8D,KAAKC,mBAGT,2BAAItE,GAAX,IAAkBkB,OAAQhB,M,kCAGlBF,EAAoBC,EAAoBC,GAChD,OAAIF,EAAMkB,OACC,2BAAIlB,GAAX,IAAkBqB,EAAGuD,EAAOC,YAAY7E,EAAMkB,OAAQhB,KAEnDF,I,kCAGCA,GACR,OAAIA,EAAMkB,QAAUlB,EAAMqB,EACf,cAAC,GAAD,CAAkBjC,MAAOY,IAC7B,O,wCAIP,MAAO,CACHX,KAAMQ,EAAakC,YACnBwC,OAAQ,EACRvD,YAAa,EACbN,YAAa,KACbG,cAAe,S,mCAIIiE,EAAWC,GAClC,IAAMC,EAAKD,EAAGlC,EAAIiC,EAAGjC,EACfoC,EAAKF,EAAGhC,EAAI+B,EAAG/B,EACrB,OAAOmC,KAAKC,KAAKH,EAAGA,EAAKC,EAAGA,O,GApCAlF,GCAfqF,G,sKACTpF,EAAqBC,EAAoBC,GAC7C,OAAIF,EAAMuD,OAAO8B,OAAS,GAAKnF,EAAE2C,IAAM7C,EAAMuD,OAAO,GAAGV,GAAK3C,EAAE6C,IAAM/C,EAAMuD,OAAO,GAAGR,EACzEsB,KAAKiB,SAAStF,EAAOC,GACzB,2BAAID,GAAX,IAAkBuD,OAAQvD,EAAMuD,OAAOkB,OAAO,CAACvE,EAAGA,Q,kCAG1CF,EAAqBC,EAAoBC,GACjD,GAA4B,IAAxBF,EAAMuD,OAAO8B,OACb,OAAOrF,EAEX,IAAMuD,EAAM,aAAOvD,EAAMuD,QAGzB,OAFAA,EAAOmB,MACPnB,EAAOoB,KAAKzE,GACL,2BAAIF,GAAX,IAAkBuD,a,+BAGbvD,EAAqBC,GAC1B,IAAMsD,EAAM,aAAOvD,EAAMuD,QAKzB,OAJAA,EAAOmB,MAEPzE,EAASd,EADE,2BAAOa,GAAP,IAAcuD,SAAQtB,GAAI1B,QAG9B8D,KAAKC,oB,kCAGJtE,GACR,OAAO,cAAC,GAAD,CAAkBZ,MAAOY,M,wCAGhC,MAAO,CACHX,KAAMQ,EAAagC,aACnB0C,OAAQ,EACRvD,YAAa,EACbuC,OAAQ,GACR1C,cAAe,KACfH,YAAa,KACbuB,GAAI,O,GArCqBlC,I,SNCzBO,O,mBAAAA,I,eAAAA,I,uBAAAA,I,mBAAAA,I,sBAAAA,M,KAQZ,IAAMiF,IAAO,mBACRjF,EAAMkF,OAAS,IAAIpF,GADX,cAERE,EAAMmF,KAAO,IAAIrB,IAFT,cAGR9D,EAAMoF,SAAW,IAAIlB,IAHb,cAIRlE,EAAMqF,OAAS,IAAIf,IAJX,cAKRtE,EAAMsF,QAAU,IAAIR,IALZ,GOdAS,GAAmB,SAAC7F,GAAD,OAA6BA,EAAM8F,OAAOC,UAC7DC,GAAmB,SAAChG,GAAD,OAAiCA,EAAM8F,OAAOnG,UACjEsG,GAAe,SAACjG,GAAD,OAA4BA,EAAM8F,OAAOI,cACxDC,GAAsB,SAACnG,GAAD,OAAoCA,EAAM8F,OAAOM,aCJvEC,GAAiB,iBACjBC,GAAoB,oBACpBC,GAAkB,kBCFxB,IAAMC,GAAc,WACvB,IAAIhG,EAAS,EACb,OAAO,mBAAQA,GAFQ,GAOrBiG,GAA2B,GCAjC,IAAMrI,GAAMC,YAAI,cAiCDqI,GA/BI,WACf,IAAMzG,EAAW0G,cACXT,EAAexD,YAAYuD,IAC3BtG,EAAW+C,YAAYsD,IACvBY,EAAUC,cAEVC,EAASC,cACT9E,EAAK6E,EAAO7E,GAAK+E,SAASF,EAAO7E,IAAM,KAEvCgF,EAAaC,uBAAY,WFV5B,IAAiBC,EEWhBlH,GFXgBkH,EEWC,CACblF,GAAW,OAAPA,EAAcA,EAAKuE,KACvB7G,YFZD,CACHN,KAAMgH,GACNc,UEYAP,EAAQjC,KAAK,YACd,CAAChF,EAAUM,EAAU2G,EAAS3E,IAEjC,OACI,sBAAKtE,UAAWS,GAAI,WAApB,UACI,wBAAQT,UAAU,SAASyJ,QAASH,EAApC,kBACA,sBAAKtJ,UAAU,iCAAf,UACI,wBAAQA,UAAW,UAAYuI,IAAiB5F,EAAMkF,OAAS,WAAa,IAAK4B,QAAS,kBAAMnH,EAAST,EAAWc,EAAMkF,UAA1H,oBACA,wBAAQ7H,UAAW,UAAYuI,IAAiB5F,EAAMmF,KAAO,WAAa,IAAK2B,QAAS,kBAAMnH,EAAST,EAAWc,EAAMmF,QAAxH,kBACA,wBAAQ9H,UAAW,UAAYuI,IAAiB5F,EAAMoF,SAAW,WAAa,IAAK0B,QAAS,kBAAMnH,EAAST,EAAWc,EAAMoF,YAA5H,sBACA,wBAAQ/H,UAAW,UAAYuI,IAAiB5F,EAAMqF,OAAS,WAAa,IAAKyB,QAAS,kBAAMnH,EAAST,EAAWc,EAAMqF,UAA1H,oBACA,wBAAQhI,UAAW,UAAYuI,IAAiB5F,EAAMsF,QAAU,WAAa,IAAKwB,QAAS,kBAAMnH,EAAST,EAAWc,EAAMsF,WAA3H,4BCJDyB,GAzBQ,SAAC3J,GAAkB,IAAD,EACX4J,mBAAS5J,EAAM6J,cADJ,mBAC9BC,EAD8B,KACvBC,EADuB,KAG/BC,EAAWR,uBAAY,SAAAhH,GACzB,IAAMyH,EAAMzH,EAAE0H,OAAOJ,MACrB,GAAY,KAARG,EAAY,CACZ,GAAIjK,EAAM0D,SACN,OAGJ,OAFAqG,EAAS,WACT/J,EAAMgK,SAAS,MAInB,IAAMG,EAAIb,SAASW,GACnBF,EAASI,GACTnK,EAAMgK,SAASG,KAChB,CAACJ,EAAU/J,EAAMgK,SAAUhK,EAAM0D,WAEpC,OACI,qBAAKzD,UAAU,UAAf,SACI,uBAAO0B,KAAK,SAAS1B,UAAU,QAAQ+J,SAAUA,EAAUF,MAAK,OAAEA,QAAF,IAAEA,IAAS,QCOxEM,GA3BM,SAACpK,GAAkB,IAAD,EACT4J,mBAAS5J,EAAM6J,cADN,mBAC5BC,EAD4B,KACrBC,EADqB,KAG7BC,EAAWR,uBAAY,SAAAhH,GACzB,IAAMyH,EAAMzH,EAAE0H,OAAOJ,MACrB,GAAY,KAARG,EAAY,CACZ,GAAIjK,EAAM0D,SACN,OAGJ,OAFAqG,EAAS,WACT/J,EAAMgK,SAAS,MAInBD,EAASE,GACT,IAAME,EAAIE,WAAW7H,EAAE0H,OAAOJ,OACzBQ,MAAMH,IACPnK,EAAMgK,SAASG,KAEpB,CAACJ,EAAU/J,EAAMgK,SAAUhK,EAAM0D,WAEpC,OACI,qBAAKzD,UAAU,UAAf,SACI,uBAAO0B,KAAK,SAAS1B,UAAU,QAAQ+J,SAAUA,EAAUF,MAAK,OAAEA,QAAF,IAAEA,IAAS,GAAIS,KAAK,WCajFC,GAlCM,SAACxK,GAAkB,IAAD,MACT4J,mBAAS5J,EAAM6J,cADN,mBAC5BC,EAD4B,KACrBC,EADqB,KAG7BC,EAAWR,uBAAY,SAAAhH,GAAM,IAAD,EACxBiI,EAAOjI,EAAE0H,OAAOQ,KAChBT,EAAG,UAAGzH,EAAE0H,OAAOJ,aAAZ,QAAqB,KAE9B,GAAY,OAARG,IAAgBjK,EAAM0D,SAA1B,CAGAqG,EAAS,2BAAID,GAAL,kBAAaW,EAAQR,KAC7B,IAAME,EAAIE,WAAW7H,EAAE0H,OAAOJ,OACxBa,EAAiB,OAARV,EAAeA,EAAME,EAC/BG,MAAMK,IACP3K,EAAMgK,SAAN,2BAAmBF,GAAnB,kBAA2BW,EAAOE,QAEvC,CAACb,EAAOC,EAAU/J,EAAMgK,SAAUhK,EAAM0D,WAE3C,OACI,qBAAKzD,UAAU,UAAf,SACI,sBAAKA,UAAU,UAAf,UACI,sBAAKA,UAAU,SAAf,UACI,qCACA,uBAAO0B,KAAK,SAAS1B,UAAU,QAAQyK,KAAK,IAAIV,SAAUA,EAAUF,MAAK,iBAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAO3E,SAAT,QAAc,QAE3F,sBAAKlF,UAAU,SAAf,UACI,qCACA,uBAAO0B,KAAK,SAAS1B,UAAU,QAAQyK,KAAK,IAAIV,SAAUA,EAAUF,MAAK,iBAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAOzE,SAAT,QAAc,c,kCC5B9FuF,GAAe,OAEtB7B,GAA6B,CAC/B8B,EAAGD,IAGME,GAAU,WACnB,IAAIhI,EAAS,EACb,OAAO,mBAAQA,GAFI,GCLvB,IAAMpC,GAAMC,YAAI,kBAEVoK,GAAa,kBACf,sBAAKC,QAAQ,cAAcC,oBAAoB,OAAOhL,UAAWS,GAAI,aAArE,UACI,0BAAUmF,OAAO,8BAA8BJ,OAAO,OAAOzC,YAAY,IAAIiD,KAAK,SAClF,sBAAMf,GAAG,MAAME,GAAG,IAAIE,GAAG,IAAIE,GAAG,MAAMC,OAAO,OAAOzC,YAAY,MAChE,sBAAMkC,GAAG,IAAIE,GAAG,IAAIE,GAAG,MAAME,GAAG,MAAMC,OAAO,OAAOzC,YAAY,UAclEkI,GAAaC,IAAMC,YAAW,SAACpL,EAAwBqL,GAAc,IAC/D9G,EAAqDvE,EAArDuE,GAAIQ,EAAiD/E,EAAjD+E,MAAOuG,EAA0CtL,EAA1CsL,QAASC,EAAiCvL,EAAjCuL,SAAUC,EAAuBxL,EAAvBwL,SAAU1G,EAAa9E,EAAb8E,SADsB,EAEtC8E,oBAAS,GAF6B,mBAE/D6B,EAF+D,KAErDC,EAFqD,KAGhEnJ,EAAW0G,cAEX0C,EAAWnC,uBAAY,WACzBkC,GAAY,KACb,CAACA,IAEEE,EAAYpC,uBAAY,WAC1BkC,GAAY,KACb,CAACA,IAEEG,EAAarC,uBAAY,SAACzE,GAC5BxC,ECPD,SAAqBgC,EAAYQ,GACpC,MAAO,CACHpD,KAjC4B,uBAkC5B4C,KACAQ,SDGS+G,CAAYvH,EAAcQ,EAAMgH,QAC1C,CAACxJ,EAAUgC,IAEd,OACI,sBAAK8G,IAAKA,EAAK3B,QAAS,kBAAM8B,GAAYA,EAASjH,IAAKtE,UAAWS,GAAI,OAAQoE,EAAW,CAAC,UAAY,IAAvG,UACI,sBAAK7E,UAAWS,GAAI,QAApB,UACI,sBAAMT,UAAWS,GAAI,SAAUsL,MAAO,CAACC,gBAAiBlH,GAAxD,UACMA,GAAS,cAAC,GAAD,MAEf,sBAAM9E,UAAWS,GAAI,SAArB,gBAAgCqE,QAAhC,IAAgCA,IAAS,YAE9B,kBAAPR,GAAmB,sBAAKtE,UAAWS,GAAI,WAApB,UACtB4K,GAAW,wBAAQ5B,QAASiC,EAAU1L,UAAWS,GAAI,SAAU,CAAC,SAArD,SACR,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,mBAGpBsL,GAAY,wBAAQ7B,QAAS,kBAAM6B,EAAShH,IAAKtE,UAAWS,GAAI,SAAU,CAAC,WAA/D,SACT,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,wBAIxBwL,GAAY,sBAAKxL,UAAWS,GAAI,WAApB,UACT,qBAAKT,UAAWS,GAAI,WAAYgJ,QAASkC,IACzC,cAAC,KAAD,CAAc7G,MAAOA,EAAOmH,iBAAkBL,aA8D/CM,GAjDc,SAACnM,GAAkB,IAAD,EACjB4J,mBAAS5J,EAAM6J,cADE,mBACpCC,EADoC,KAC7BC,EAD6B,KAErCtF,EAAUO,YAAYN,GACtB0H,EAAMC,OAAOC,KAAK7H,GAASqB,KAAI,SAAAyG,GAAC,OAAIjD,SAASiD,EAAG,OAChDC,EAAcC,mBACdlK,EAAW0G,cAEXyD,EAAkBlD,uBAAY,SAACjF,GACjCwF,EAASxF,GACTvE,EAAMgK,SAASzF,KAChB,CAACwF,EAAU/J,EAAMgK,WAEd2C,EAAenD,uBAAY,SAACjF,GAC9BhC,ECtED,SAAqBgC,GACxB,MAAO,CACH5C,KAtB4B,uBAuB5B4C,MDmESqI,CAAYrI,MACtB,CAAChC,IAEEsK,EAAiBrD,uBAAY,WAC/BjH,ECrFG,CACHZ,KAXyB,oBAYzB4C,GDmFkBuG,KClFlB/F,MDkF4B6F,OAC7B,CAACrI,IAMJ,OAJAuK,qBAAU,WAAO,IAAD,EACZ,QAAC,EAAAN,EAAYO,eAAb,SAA8BC,mBAC/B,IAGC,qBAAK/M,UAAWS,KAAhB,SACI,sBAAKT,UAAWS,GAAI,SAApB,WACMV,EAAM0D,UAAY,cAACwH,GAAD,CAAY3G,GAAI,KAAMiH,SAAUkB,EAAiB5H,SAAoB,OAAVgF,IAC9EsC,EAAItG,KAAI,SAAAvB,GAAE,OACP,cAAC2G,GAAD,CAAY3G,GAAIA,EAAaQ,MAAON,EAAQF,GAChC+G,SAAO,EACPC,SAAiB,IAAPhH,OAAWC,EAAYmI,EACjCnB,SAAUkB,EACV5H,SAAUgF,IAAUvF,EACpB8G,IAAKvB,IAAUvF,EAAKiI,OAAchI,GALrBD,MAS7B,sBAAKmF,QAASmD,EAAgB5M,UAAWS,GAAI,OAAQ,CAAC,QAAtD,UACI,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,kBAFrB,qBEpHVS,GAAMC,YAAI,cAUDsM,GARI,SAACjN,GAAD,OACf,qBAAKC,UAAWS,KAAhB,SACI,qBAAKT,UAAWS,GAAI,WAApB,SACKV,EAAMG,cCKbO,GAAMC,YAAI,kBAEVuM,GAAgB,SAAClN,GACnB,IAAMuC,EAAW0G,cAEXkE,EAAgB3D,uBAAY,SAACM,GAC/BvH,EtB4CD,SAAwB6K,EAAiBC,EAAkBvD,GAC9D,MAAO,CACHnI,KAAMN,EACN+L,UACAC,WACAvD,SsBjDSwD,CAAetN,EAAMuN,SAAUvN,EAAMqN,SAAUvD,MACzD,CAAC9J,EAAMuN,SAAUvN,EAAMqN,SAAU9K,IAE9BiL,EAAiBhE,uBAAY,YAAyC,IAAvCK,EAAsC,EAAtCA,aAAcG,EAAwB,EAAxBA,SAAUtG,EAAc,EAAdA,SACzD,OAAQ1D,EAAMyN,SAAS9L,MACnB,KAAKS,EAAasL,QACd,OAAO,cAAC,GAAD,CAAgB7D,aAAcA,EAAcG,SAAUA,EAAUtG,SAAUA,IACrF,KAAKtB,EAAac,MACd,OAAO,cAAC,GAAD,CAAc2G,aAAcA,EAAcG,SAAUA,EAAUtG,SAAUA,IACnF,KAAKtB,EAAaqB,MACd,OAAO,cAAC,GAAD,CAAcoG,aAAcA,EAAcG,SAAUA,EAAUtG,SAAUA,IACnF,KAAKtB,EAAagB,MACd,OAAO,cAAC,GAAD,CAAsByG,aAAcA,EAAcG,SAAUA,EAAUtG,SAAUA,IAC3F,QACI,OAAO,QAEhB,CAAC1D,EAAMyN,SAAS9L,KAAM3B,EAAMuN,WAE/B,OACI,sBAAKtN,UAAU,QAAf,UACI,uBAAOA,UAAU,QAAjB,SACKD,EAAMyN,SAASxK,QAEpB,cAACuK,EAAD,CAAgB3D,aAAc7J,EAAM6J,aAAcG,SAAUmD,QAKlEQ,GAAmB,SAAC3N,GACtB,IXxC0B6B,EWwCpBH,EAAQsD,aXxCYnD,EWwCc7B,EAAMuN,SXxCJ,SAACjL,GAAD,OAA+BA,EAAM8F,OAAOnG,SAASJ,MWyC/F,IAAKH,EAAO,OAAO,KAEnB,IAAMkM,EAA4B3J,EAAcvC,EAAMC,MAChDkM,EAAaxB,OAAOC,KAAKsB,GAE/B,OACI,8BACKC,EAAW/H,KAAI,SAAA2E,GAAI,OAChB,cAAC,GAAD,CAEIgD,SAAUG,EAAcnD,GACxB4C,SAAU5C,EACVZ,aAAcnI,EAAM+I,GACpB8C,SAAUvN,EAAMuN,UAJX9C,SA4BVqD,GAlBW,WACtB,IAAMpF,EAAc1D,YAAYyD,IAEhC,OACI,qBAAKxI,UAAWS,KAAhB,SACI,eAAC,GAAD,WACI,oBAAIT,UAAW,SAAWS,GAAI,SAA9B,wBAEiB,OAAhBgI,EACG,mBAAGzI,UAAWS,GAAI,OAAQ,CAAC,eAA3B,+BAEA,cAAC,GAAD,CAAkB6M,SAAU7E,UCrDjCqF,GAXG,SAAC/N,GACf,OACI,8CAAKqL,IAAKrL,EAAMgO,OAAQhD,QAAQ,cAAc/K,UAAWD,EAAMU,IAAI,QAAYV,EAAM0F,eAArF,cACK1F,EAAMG,SACNH,EAAMiO,SAAW,mBAAGhO,UAAU,oBAAb,SACbD,EAAMiO,eCIRC,GAlBC,SAAClO,GACb,IAAMmO,EAAiB,IAAInO,EAAMqI,SAAW,EACtC+F,EAAOpO,EAAMqI,SACbgG,EAAQC,MAAMH,GAAgBlI,KAAK,GACzC,OACI,qCACKoI,EAAMvI,KAAI,SAACyI,EAAG1M,GAAJ,OACP,sBAAgBqD,GAAI,EAAGE,GAAIvD,EAAMuM,EAAM9I,GAAI,IAAKE,GAAI3D,EAAMuM,EAAM3I,OAAO,OAAO+I,cAAe,GACvFxL,YAAa,EAAGyL,aAAa,sBADxB5M,MAGdwM,EAAMvI,KAAI,SAACyI,EAAG1M,GAAJ,OACP,sBAAgBuD,GAAI,EAAGF,GAAIrD,EAAMuM,EAAM5I,GAAI,IAAKF,GAAIzD,EAAMuM,EAAM3I,OAAO,OAAO+I,cAAe,GACrFxL,YAAa,EAAGyL,aAAa,sBAD1B5M,UCdd6M,GAAgB,SAACpM,GAAD,OAA6BA,EAAMqM,OCW1DjO,GAAMC,YAAI,cA0GDiO,GA3ES,WAAO,IAAD,EA7BuE,WAAO,IAAD,EAC9EhF,mBAAS,MADqE,mBAChGiF,EADgG,KAC3FC,EAD2F,OAEvElF,mBAAS,MAF8D,mBAEhGmF,EAFgG,KAEtFC,EAFsF,KA0BvG,MAAO,CAvBKxF,uBAAY,SAAAyF,GACT,OAAPA,IACAH,EAAUG,GACVD,EAAYC,EAAGC,qBAEpB,CAACJ,IAEqBtF,uBAAwD,SAAChH,EAAG4L,GAAiB,IAAD,EACjG,GAAiB,OAAbW,EACA,MAAO,CAAC5J,EAAG,EAAGE,EAAG,GAErB0J,EAAS5J,EAAI3C,EAAE2M,QAEfJ,EAAS1J,EAAI7C,EAAE4M,QAGf,IAAMC,EAAcN,EAASO,gBAAT,UAAyBT,EAAIU,sBAA7B,aAAyB,EAAoBC,WACjE,MAAO,CACHrK,EAAGqC,KAAKiI,MAAMJ,EAAYlK,EAAIiJ,GAAQA,EACtC/I,EAAGmC,KAAKiI,MAAMJ,EAAYhK,EAAI+I,GAAQA,KAE3C,CAACW,EAAUF,KAMqBa,GADT,mBACnB1B,EADmB,KACX2B,EADW,KAEpBvB,EAAOpJ,YAAYmD,IACnBK,EAAexD,YAAYuD,IAC3BG,EAAc1D,YAAYyD,IAC1BxG,EAAW+C,YAAYsD,IALH,EAMUsB,mBAAwC,MANlD,mBAMnBgG,EANmB,KAMPC,EANO,KAOpB9N,EtBXa,SAACA,GACpB,IAAMQ,EAAW0G,cAD6B,EAENW,mBAAoB/B,GAAQ9F,IAFtB,mBAEvCyG,EAFuC,KAEzBsH,EAFyB,OAGZlG,mBAAcpB,EAAa5B,mBAHf,mBAGvCmJ,EAHuC,KAG5BC,EAH4B,KAK9ClD,qBAAU,WACNgD,EAAgBjI,GAAQ9F,IACxBiO,EAAanI,GAAQ9F,GAAM6E,qBAC5B,CAAC7E,IAEJ,IAAM2H,EAAUF,uBAAY,SAAChH,GACzBwN,EAAaxH,EAAakB,QAAQqG,EAAWxN,EAAUC,MACxD,CAACuN,EAAWxN,EAAUyN,EAAcxH,IAEjCyH,EAAczG,uBAAY,SAAChH,GAC7BwN,EAAaxH,EAAayH,YAAYF,EAAWxN,EAAUC,MAC5D,CAACuN,EAAWxN,EAAUyN,EAAcxH,IAEjC0H,EAAe1G,uBAAY,SAAChH,GAC9BwN,EAAaxH,EAAa0H,aAAaH,EAAWxN,EAAUC,MAC7D,CAACuN,EAAWxN,EAAUyN,EAAcxH,IAEjC2H,EAAe3G,uBAAY,SAAC3H,EAAKH,GACnCsO,EAAaxH,EAAa2H,aAAaJ,EAAWxN,EAAUV,EAAKH,MAClE,CAACqO,EAAWxN,EAAUyN,EAAcxH,IAMvC,MAAO,CACH4H,iBAAkB,CACd1G,UACAuG,cACAC,eACAtI,SATS4B,uBAAY,WACzBwG,EAAaxH,EAAaZ,SAASmI,EAAWxN,MAC/C,CAACwN,EAAWxN,EAAUyN,EAAcxH,KASnC2H,eACAE,cAAe7H,EAAa8H,YAAYP,GACxCQ,eAAgB/H,EAAa+H,iBAC7BC,SAAUhI,EAAagI,YsB7BdC,CAAQjI,GACfjG,EAAW0G,cAEXG,EAASC,cACT9E,EAAK6E,EAAO7E,GAAK+E,SAASF,EAAO7E,IAAM,KACvCkF,EAAOzE,YDrDW,SAACT,GAAD,OAAuB,SAACjC,GAAD,OAAuCA,EAAMqM,MAAM+B,MAAK,SAAAC,GAAC,OAAIA,EAAEpM,KAAOA,MCqD5FqM,CAAarM,IAEhCsM,EAAcrH,uBAAY,SAAChH,GAC7B,IAAMsO,EAAQnB,EAAiBnN,EAAG4L,GAClCrM,EAAKqO,iBAAiB1G,QAAQoH,KAC/B,CAACnB,EAAkBvB,EAAMrM,EAAKqO,iBAAiB1G,UAE5CqH,EAAkBvH,uBAAY,SAAAhH,GAChC,IAAMsO,EAAQnB,EAAiBnN,EAAG4L,GAClCyB,EAAciB,KACf,CAAC1C,EAAMuB,IAEJqB,EAAkBxH,uBAAY,SAAAhH,GAChCqN,EAAc,MACd9N,EAAKqO,iBAAiBF,aAAaP,EAAiBnN,EAAG4L,MACxD,CAACyB,EAAeF,EAAkBvB,EAAMrM,EAAKqO,iBAAiBF,eAE3De,EAAmBzH,uBAAY,SAAChH,EAAmBX,GACjDE,EAAKyO,WAAatO,EAASS,cAC3BH,EAAE0O,kBACFnP,EAAKoO,aAAatO,EAAKI,EAASJ,OAErC,CAACE,EAAKoO,aAAclO,IAEjBkP,EAAoB3H,uBAAY,SAAChH,GACnCA,EAAE4O,iBACFrP,EAAKqO,iBAAiBxI,aACvB,CAAC7F,EAAKqO,iBAAiBxI,WAa1B,OAXAkF,qBAAU,WACN8C,GAAc7N,EAAKqO,iBAAiBH,YAAYL,KACjD,CAACA,IAEJ9C,qBAAU,WACNvK,E1BSG,CACHZ,KAAMH,I0BTK,OAAP+C,GAAekF,GACflH,EAASP,EAAYyH,EAAKxH,aAE/B,CAACsC,EAAIkF,EAAMlH,IAGV,eAAC,GAAD,CAAWyL,OAAQA,EAAQtN,IAAKA,GACrBgF,cAAe,CACXgE,QAASmH,EACTZ,YAAac,EACbb,aAAcc,EACdK,cAAeF,GAEnBlD,QACI,qCACI,cAAC,GAAD,CAAS5F,SAAU+F,IAClBwB,GAAc7N,EAAKwO,gBACpB,wBAAQlK,GAAIuJ,EAAWzK,EAAGmB,GAAIsJ,EAAWvK,EAAG1B,EAAG,EAAG8B,OAAO,QAAQzC,YAAa,EACtEyL,aAAa,0BAZxC,UAgBKxM,EAAS6D,KAAI,SAACmJ,EAAIpN,GAAL,OAAa,cAAC,GAAD,CAA8BiD,SAAUjD,IAAQ6G,EAAahH,MAAOuN,EAAIvJ,cAAe,CAACgE,QAAS,SAAClH,GAAD,OAAuByO,EAAiBzO,EAAGX,MAArHoN,EAAG1K,OACpDxC,EAAKsO,kB,SCnHX,SAASiB,GAAWC,EAAWC,EAAoBC,GACtD,IAAMC,EAASpD,MAAMqD,KAAKJ,GADmD,EAE3DG,EAAOE,OAAOJ,EAAY,GAArCK,EAFsE,oBAK7E,OAFAH,EAAOE,OAAOH,EAAU,EAAGI,GAEpBH,ECOX,IAAMhR,GAAMC,YAAI,sBAEVmR,GAAe,SAACpQ,GAClB,IAAIC,EAAO,UAEX,OAAQD,EAAMC,MACV,KAAKQ,EAAagC,aACdxC,EAAO,UACP,MACJ,KAAKQ,EAAakC,YACd1C,EAAO,SACP,MACJ,KAAKQ,EAAaiC,cACdzC,EAAO,WACP,MACJ,KAAKQ,EAAa+B,UACdvC,EAAO,OAIf,MAAM,GAAN,OAAUA,EAAV,aAAmBD,EAAM6C,KA4FdwN,GAzFU,WACrB,IAAM9P,EAAW+C,YAAYsD,IACvBI,EAAc1D,YAAYyD,IAC1BlG,EAAW0G,cAEX+I,EAAexI,uBAAY,SAAChH,EAAmBX,GACjDW,EAAE0O,kBACF3O,EAASX,EAAYK,EAAS0F,OAAS9F,EAAM,MAC9C,CAACU,EAAUN,IAERgQ,EAAgBzI,uBAAY,SAACkI,GAC1BA,EAAOQ,aAGZ3P,EAASP,EAAYsP,GACjBrP,EACAA,EAAS0F,OAAS+J,EAAOS,OAAOC,MAAQ,EACxCnQ,EAAS0F,OAAS+J,EAAOQ,YAAYE,MAAQ,OAElD,CAACnQ,EAAUM,IAERoK,EAAenD,uBAAY,SAAChH,EAAmB+B,GACjD/B,EAAE0O,kBACF3O,E5B6BD,SAAuBgC,GAC1B,MAAO,CACH5C,KAAMJ,EACNgD,M4BhCS8N,CAAc9N,MACxB,CAAChC,IAEE+P,EAAiB9I,uBAAY,WAC/BjH,EAASX,EAAY,SACtB,CAACW,IAEEgQ,EAAgB,aAAOtQ,GAG7B,OAFAsQ,EAAiBC,UAGb,cAAC,KAAD,CAAiBC,UAAWR,EAA5B,SACI,qBAAKhS,UAAWS,KAAOgJ,QAAS4I,EAAhC,SACI,cAAC,GAAD,UACI,sBAAKrS,UAAWS,GAAI,WAApB,UACI,oBAAIT,UAAU,QAAd,sBACA,cAAC,KAAD,CAAWyS,YAAY,WAAvB,SACM,SAACC,EAAUC,GAAX,OACE,gDACQD,EAASE,gBADjB,IAEIxH,IAAKsH,EAASG,SACd7S,UAAWS,GAAI,SAHnB,UAKK6R,EAAiBzM,KAAI,SAACmJ,EAAIpN,GAAL,OAClB,cAAC,KAAD,CAAWkR,YAAa9D,EAAG1K,GAAGyO,WAAYZ,MAAOvQ,EAAjD,SACK,SAACoR,GAAD,OACG,0DAEIvJ,QAAS,SAAClH,GAAD,OAAOwP,EAAaxP,EAAGX,IAChC5B,UAAWS,GAAI,OAAQgI,IAAiBzG,EAAS0F,OAAS9F,EAAM,EAAI,CAAC,UAAY,KAC7EoR,EAAcC,gBACdD,EAAcE,iBALtB,IAMI9H,IAAK4H,EAAcH,SANvB,UAQI,sBAAK7S,UAAWS,GAAI,QAApB,UACI,qBAAKT,UAAWS,GAAI,SAApB,SACI,cAAC,GAAD,CAAWA,IAAKA,GAAhB,SACI,cAAC,GAAD,CAAkBgB,MAAOuN,QAGjC,qBAAKhP,UAAWS,GAAI,SAApB,SACKoR,GAAa7C,QAGtB,qBAAKhP,UAAWS,GAAI,WAApB,SACI,wBAAQgJ,QAAS,SAAClH,GAAD,OAAOmK,EAAanK,EAAGyM,EAAG1K,KAAKtE,UAAWS,GAAI,SAAU,CAAC,WAA1E,SACI,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,0BApBpBgP,EAAG1K,MAHuC0K,EAAG1K,OA+BjEoO,EAASS,6BCzGxC1S,GAAMC,YAAI,cAgBD0S,GAdG,WACd,OACI,qBAAKpT,UAAWS,KAAhB,SACI,cAAC,EAAD,CAAaG,YAAU,EAACE,KAAM,cAAC,GAAD,IAAsBC,MAAO,cAAC,GAAD,IAA3D,SACI,cAAC,EAAD,CAAaD,KAAM,cAAC,GAAD,IAAnB,SACI,qBAAKd,UAAWS,GAAI,QAApB,SACI,cAAC,GAAD,aCFT4S,GARI,WACf,OACI,cAAC,EAAD,CAAsBpT,OAAQ,cAAC,EAAD,IAAYE,OAAQ,cAAC,EAAD,IAAlD,SACI,cAAC,GAAD,OCIGmT,GARG,WACd,OACI,cAAC,EAAD,CAAsBrT,OAAQ,cAAC,EAAD,IAAYE,OAAQ,cAAC,EAAD,IAAlD,SACI,8CCCNM,GAAMC,YAAI,aAwCH6S,GAAc,SAAC,GAAD,IAAE9J,EAAF,EAAEA,QAAF,OACvB,qBAAKA,QAASA,EAASzJ,UAAWS,GAAI,CAAC,QAAvC,SACI,sBAAMT,UAAU,OAAhB,SAAuB,mBAAGA,UAAU,2BAI7BwT,GA5CE,SAACzT,GACd,IAAMuC,EAAW0G,cACXC,EAAUC,cAEV0C,EAAarC,uBAAY,WAC3BN,EAAQjC,KAAR,iBAAuBjH,EAAMyJ,KAAKlF,OACnC,CAACvE,EAAMyJ,KAAMP,IAEVyD,EAAenD,uBAAY,WpBG9B,IAAoBjF,EoBFnBhC,GpBEmBgC,EoBFCvE,EAAMyJ,KAAKlF,GpBG5B,CACH5C,KAAMiH,GACNrE,UoBJD,CAACvE,EAAMyJ,KAAMlH,IAEhB,OACI,sBAAKtC,UAAWS,KAAhB,UACI,sBAAKT,UAAWS,GAAI,SAApB,UACI,cAAC,GAAD,CAAWA,IAAKA,GAAhB,SACKV,EAAMyJ,KAAKxH,SAAS6D,KAAI,SAAAmJ,GAAE,OAAI,cAAC,GAAD,CAA8BvN,MAAOuN,GAAdA,EAAG1K,SAE7D,sBAAKtE,UAAWS,GAAI,WAApB,UACI,wBAAQgJ,QAASmC,EAAY5L,UAAWS,GAAI,SAAU,CAAC,SAAvD,SACI,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,mBAGrB,wBAAQyJ,QAASiD,EAAc1M,UAAWS,GAAI,SAAU,CAAC,WAAzD,SACI,sBAAMT,UAAU,OAAhB,SACI,mBAAGA,UAAU,2BAK7B,qBAAKA,UAAWS,GAAI,SAApB,SACI,uBAAMT,UAAU,gBAAhB,kBAAsCD,EAAM6B,aChCtDnB,GAAMC,YAAI,SA+BD+S,GA5BD,WACV,IAAM/E,EAAQ3J,YAAY0J,IACpBxF,EAAUC,cAEVwK,EAAenK,uBAAY,WAC7BN,EAAQjC,KAAK,gBACd,CAACiC,IAEJ,OACI,cAAC,EAAD,CAAsBhJ,OAAQ,cAAC,EAAD,IAAYE,OAAQ,cAAC,EAAD,IAAlD,SACI,cAAC,GAAD,UACI,sBAAKH,UAAWS,KAAhB,UACI,sBAAKT,UAAWS,GAAI,WAApB,UACI,oBAAIT,UAAU,QAAd,mBACA,mBAAGA,UAAWS,GAAI,WAAlB,SACI,cAAC,IAAD,CAASF,GAAG,iBAAZ,0BAGR,sBAAKP,UAAWS,GAAI,SAApB,UACKiO,EAAM7I,KAAI,SAAC2D,EAAM5H,GAAP,OAAe,cAAC,GAAD,CAAwBA,IAAKA,EAAK4H,KAAMA,GAAzBA,EAAKlF,OAC9C,cAAC,GAAD,CAAamF,QAASiK,eCnBxCjT,GAAMC,YAAI,WA4EDiT,GAzEC,WACZ,IAAMjF,EAAQ3J,YAAY0J,IACpBnM,EAAW0G,cAEXgJ,EAAgBzI,uBAAY,SAACkI,GAC1BA,EAAOQ,aAGZ3P,EtBOD,SAAkBoM,GACrB,MAAO,CACHhN,KAAMkH,GACN8F,SsBVSkF,CAASvC,GACd3C,EACA+C,EAAOS,OAAOC,MACdV,EAAOQ,YAAYE,WAExB,CAACzD,EAAOpM,IAEX,OACI,cAAC,EAAD,CAAsBrC,OAAQ,cAAC,EAAD,IAAYE,OAAQ,cAAC,EAAD,IAAlD,SACI,cAAC,GAAD,UACI,cAAC,KAAD,CAAiBqS,UAAWR,EAA5B,SACI,sBAAKhS,UAAWS,KAAhB,UACI,sBAAKT,UAAWS,GAAI,WAApB,UACI,oBAAIT,UAAU,QAAd,2BACA,mBAAGA,UAAWS,GAAI,WAAlB,SACI,cAAC,IAAD,CAASF,GAAG,SAAZ,uBAGR,mBAAGP,UAAU,WAAb,0CACA,sBAAKA,UAAWS,GAAI,WAApB,UACI,qBAAKT,UAAWS,GAAI,MAAO,CAAC,QAA5B,SACKiO,EAAM7I,KAAI,SAACyI,EAAG1M,GAAJ,OACP,qBAAK5B,UAAWS,GAAI,OAAQ,CAAC,QAA7B,SAAuCmB,SAG/C,cAAC,KAAD,CAAW6Q,YAAY,QAAvB,SACK,SAACC,EAAUC,GAAX,OACG,gDACQD,EAASE,gBADjB,IAEIxH,IAAKsH,EAASG,SACd7S,UAAWS,GAAI,MAAO,CAAC,UAH3B,UAKKiO,EAAM7I,KAAI,SAAC2D,EAAM5H,GAAP,OACP,cAAC,KAAD,CAAyBkR,YAAatJ,EAAKlF,GAAGyO,WAAYZ,MAAOvQ,EAAjE,SACK,SAACoR,GAAD,OACG,4DACQA,EAAcE,iBACdF,EAAcC,gBAFtB,IAGI7H,IAAK4H,EAAcH,SACnB7S,UAAWS,GAAI,OAAQ,CAAC,SAJ5B,UAMI,qBAAKT,UAAWS,GAAI,SAApB,SACI,cAAC,GAAD,CAAWA,IAAKA,GAAhB,SACK+I,EAAKxH,SAAS6D,KAAI,SAAAmJ,GAAE,OAAI,cAAC,GAAD,CAA8BvN,MAAOuN,GAAdA,EAAG1K,WAG3D,sBAAKtE,UAAWS,GAAI,SAApB,iBACS+I,EAAKlF,YAdVkF,EAAKlF,OAoBxBoO,EAASS,gCChDnCU,OAxBf,WACE,OACE,cAAC,IAAD,CAAQC,SAAU,uBAAlB,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,aAAZ,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAOA,KAAK,iBAAZ,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAOA,KAAK,aAAZ,SACI,cAAC,GAAD,MAEJ,cAAC,IAAD,CAAOA,KAAK,SAAZ,SACI,cAAC,GAAD,MAEJ,cAAC,IAAD,CAAOA,KAAK,IAAZ,SACI,cAAC,GAAD,YCVGC,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,O,mBCSRnL,GAA4B,CAC9B9G,SAAU,GACVoG,SAAU,EACVG,aAAc5F,EAAMkF,OACpBY,YAAa,MChBjB,IAAMgM,GAAcC,2BAAgB,CAChCvM,ODkBG,WAA2E,IAA3D9F,EAA0D,uDAAlDyG,GAAc6L,EAAoC,uCAC7E,OAAQA,EAAOjT,MACX,KAAKV,EACD,IAAM4T,EAAcvS,EAAML,SAAS0F,OAC7B1F,EAAQ,uBAAOK,EAAML,UAAb,CAAuB2S,EAAOlT,QAC5C,OAAO,2BAAIY,GAAX,IAAkBL,WAAUyG,YAAamM,IAC7C,KAAK3T,EACD,OAAO,2BAAIoB,GAAX,IAAkB+F,SAAUuM,EAAOE,OACvC,KAAK3T,EACD,OAAO,2BAAImB,GAAX,IAAkBoG,YAAakM,EAAO/S,MAC1C,KAAKT,EACD,OAAO,2BAAIkB,GAAX,IAAkBkG,aAAcoM,EAAO7S,OAC3C,KAAKV,EACD,OAAO,2BAAIiB,GAAX,IAAkBL,SAAUK,EAAML,SAAS6D,KACvC,SAACiP,EAAG5K,GAAJ,OAAUA,IAAMyK,EAAOxH,QAAb,2BAA2B2H,GAA3B,kBAA+BH,EAAOvH,SAAWuH,EAAO9K,QAASiL,OAEnF,KAAKzT,EACD,IAAM0T,EAAuC,OAAtB1S,EAAMoG,YAEzBkM,EAAO3S,SAASgT,WAAU,SAAAhG,GAAE,aAAIA,EAAG1K,KAAOjC,EAAML,SAAN,UAAeK,EAAMoG,mBAArB,QAAoC,GAAGnE,MAEjF,KACJ,OAAO,2BAAIjC,GAAX,IAAkBL,SAAU2S,EAAO3S,SAAUyG,YAAasM,IAC9D,KAAKzT,EACD,OAAO,2BAAIe,GAAX,IAAkBL,SAAUK,EAAML,SAASiT,QAAO,SAAAjG,GAAE,OAAIA,EAAG1K,KAAOqQ,EAAOrQ,QAC7E,KAAK/C,EACD,OAAOuH,GACX,QACI,OAAOzG,IC7CfmC,QpBWG,WAA8E,IAA7DnC,EAA4D,uDAApDyG,GAAc6L,EAAsC,uCAChF,OAAQA,EAAOjT,MACX,IAAK,oBACD,OAAO,2BAAIW,GAAX,kBAAmBsS,EAAOrQ,GAAKqQ,EAAO7P,QAC1C,IAAK,uBAAL,MACY6P,EAAOrQ,GAAkB4Q,GAAY7S,EADjD,gBACiDA,EADjD,gBAEI,OAAO6S,EACX,IAAK,uBACD,OAAO,2BAAI7S,GAAX,kBAAmBsS,EAAOrQ,GAAKqQ,EAAO7P,QAC1C,QACI,OAAOzC,IoBpBfqM,MzBGG,WAAwE,IAAzDrM,EAAwD,uDAAhDyG,GAAc6L,EAAkC,uCAC1E,OAAQA,EAAOjT,MACX,KAAKgH,GACD,IAAMyM,EAAU9S,EAAM2S,WAAU,SAAAtE,GAAC,OAAIA,EAAEpM,KAAOqQ,EAAOnL,KAAKlF,MAC1D,OAAI6Q,GAAW,EACJ9S,EAAMwD,KAAI,SAAA6K,GAAC,OAAIA,EAAEpM,KAAOqQ,EAAOnL,KAAKlF,GAArB,eAA8BqQ,EAAOnL,MAAQkH,KAEjE,GAAN,oBAAWrO,GAAX,CAAkBsS,EAAOnL,OAC7B,KAAKb,GACD,OAAOtG,EAAM4S,QAAO,SAAAzL,GAAI,OAAIA,EAAKlF,KAAOqQ,EAAOrQ,MACnD,KAAKsE,GACD,OAAO,aAAI+L,EAAOjG,OACtB,QACI,OAAOrM,MyBPJ+S,GANDC,uBAAYZ,GACtBa,kC,4BCAJC,IAASC,OACP,cAAC,IAAMC,WAAP,UACI,cAAC,IAAD,CAAUL,MAAOA,GAAjB,SACI,cAAC,GAAD,QAGRM,SAASC,eAAe,SAM1B3B,O","file":"static/js/main.e0a5ee7b.chunk.js","sourcesContent":["import React, {ReactNode, ReactNodeArray} from \"react\";\r\n\r\ninterface Props {\r\n    header?: ReactNode | ReactNodeArray\r\n    children: ReactNode | ReactNodeArray\r\n    footer?: ReactNode | ReactNodeArray\r\n}\r\n\r\nconst FullscreenPageLayout = (props: Props) => {\r\n    return (\r\n        <div className=\"fullscreen-layout\">\r\n            <div className=\"fullscreen-layout__header\">\r\n                { props.header }\r\n            </div>\r\n            <div className=\"fullscreen-layout__content\">\r\n                { props.children }\r\n            </div>\r\n            <div className=\"fullscreen-layout__footer\">\r\n                { props.footer }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default FullscreenPageLayout;\r\n","import React from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nconst Navbar = () => {\r\n    return (\r\n        <nav className=\"navbar is-info\" role=\"navigation\" aria-label=\"main navigation\">\r\n            <div className=\"navbar-brand\">\r\n                <h1 className=\"navbar-item is-flex-direction-column\">\r\n                    <span className=\"title is-4 mb-4 has-text-white\">Tile Mosaic</span>\r\n                    <span className=\"subtitle is-6 is-uppercase is-bold has-text-light\">Generator</span>\r\n                </h1>\r\n            </div>\r\n\r\n            <div className=\"navbar-menu\">\r\n                <div className=\"navbar-start\">\r\n                    <Link to=\"/\" className=\"navbar-item\">\r\n                        Generator\r\n                    </Link>\r\n\r\n                    <Link to=\"/tiles\" className=\"navbar-item\">\r\n                        Tiles\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </nav>\r\n    );\r\n}\r\n\r\nexport default Navbar;\r\n","import React from \"react\";\r\n\r\nconst Footer = () => {\r\n    return (\r\n        <footer className=\"has-background-light p-3\">\r\n            <div className=\"content has-text-centered\">\r\n                <p className=\"has-text-grey\">\r\n                    <i>Tile Mosaic Generator</i> is created by Martin Omacht as a project for VIN course\r\n                    at Brno University of Technology in 2020.\r\n                </p>\r\n            </div>\r\n        </footer>\r\n    );\r\n}\r\n\r\nexport default Footer;\r\n","import React from \"react\";\r\nimport bem from \"bem-ts\";\r\n\r\ninterface Props {\r\n    horizontal?: boolean;\r\n    left?: React.ReactNodeArray | React.ReactNode;\r\n    children: React.ReactNodeArray | React.ReactNode;\r\n    right?: React.ReactNodeArray | React.ReactNode;\r\n}\r\n\r\nconst blk = bem('panel-layout');\r\n\r\nconst PanelLayout = (props: Props) => {\r\n    const horizontal = props.horizontal;\r\n    return (\r\n        <div className={blk({horizontal, vertical: !horizontal})}>\r\n            <div className={blk('side')}>\r\n                { props.left }\r\n            </div>\r\n            <div className={blk('content')}>\r\n                { props.children }\r\n            </div>\r\n            <div className={blk('side')}>\r\n                { props.right }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default PanelLayout;\r\n","import {SvgShape} from \"../models/svg\";\r\nimport {Action} from \"redux\";\r\nimport {Tools} from \"../editor-tools\";\r\n\r\nexport const EDITOR_ADD_SHAPE = 'EDITOR_ADD_SHAPE';\r\nexport const EDITOR_SET_GRID = 'EDITOR_SET_GRID';\r\nexport const EDITOR_SELECT_SHAPE = 'EDITOR_SELECT_SHAPE';\r\nexport const EDITOR_SELECT_TOOL = 'EDITOR_SELECT_TOOL';\r\nexport const EDITOR_ELEM_PROP_CHANGE = 'EDITOR_ELEM_PROP_CHANGE';\r\nexport const EDITOR_SET_ELEMENTS = 'EDITOR_SET_ELEMENTS';\r\nexport const EDITOR_DELETE_ELEMENT = 'EDITOR_DELETE_ELEMENT';\r\nexport const EDITOR_CLEAR = 'EDITOR_CLEAR';\r\n\r\nexport interface AddShapeAction extends Action<typeof EDITOR_ADD_SHAPE> {\r\n    shape: SvgShape\r\n}\r\n\r\nexport function addShape(shape: SvgShape): AddShapeAction {\r\n    return {\r\n        type: EDITOR_ADD_SHAPE,\r\n        shape\r\n    }\r\n}\r\n\r\nexport interface SetGridAction extends Action<typeof EDITOR_SET_GRID> {\r\n    size: number;\r\n}\r\n\r\nexport function setGrid(size: number): SetGridAction {\r\n    return {\r\n        type: EDITOR_SET_GRID,\r\n        size\r\n    }\r\n}\r\n\r\nexport interface SelectShapeAction extends Action<typeof EDITOR_SELECT_SHAPE> {\r\n    idx: number | null;\r\n}\r\n\r\nexport function selectShape(idx: number | null): SelectShapeAction {\r\n    return {\r\n        type: EDITOR_SELECT_SHAPE,\r\n        idx\r\n    }\r\n}\r\n\r\nexport interface SelectToolAction extends Action<typeof EDITOR_SELECT_TOOL> {\r\n    tool: Tools\r\n}\r\n\r\nexport function selectTool(tool: Tools): SelectToolAction {\r\n    return {\r\n        type: EDITOR_SELECT_TOOL,\r\n        tool\r\n    }\r\n}\r\n\r\nexport interface ElemPropChangeAction extends Action<typeof EDITOR_ELEM_PROP_CHANGE> {\r\n    elemIdx: number;\r\n    propName: string;\r\n    value: any;\r\n}\r\n\r\nexport function elemPropChange(elemIdx: number, propName: string, value: any) {\r\n    return {\r\n        type: EDITOR_ELEM_PROP_CHANGE,\r\n        elemIdx,\r\n        propName,\r\n        value\r\n    }\r\n}\r\n\r\nexport interface SetElementsAction extends Action<typeof EDITOR_SET_ELEMENTS> {\r\n    elements: SvgShape[]\r\n}\r\n\r\nexport function setElements(elements: SvgShape[]): SetElementsAction {\r\n    return {\r\n        type: EDITOR_SET_ELEMENTS,\r\n        elements\r\n    }\r\n}\r\n\r\nexport interface DeleteElementAction extends Action<typeof EDITOR_DELETE_ELEMENT> {\r\n    id: number\r\n}\r\n\r\nexport function deleteElement(id: number): DeleteElementAction {\r\n    return {\r\n        type: EDITOR_DELETE_ELEMENT,\r\n        id\r\n    }\r\n}\r\n\r\nexport interface ClearAction extends Action<typeof EDITOR_CLEAR> {\r\n\r\n}\r\n\r\n\r\nexport function clear(): ClearAction {\r\n    return {\r\n        type: EDITOR_CLEAR\r\n    }\r\n}\r\n\r\nexport type EditorActions =\r\n    AddShapeAction |\r\n    SetGridAction |\r\n    SelectShapeAction |\r\n    SelectToolAction |\r\n    ElemPropChangeAction |\r\n    SetElementsAction |\r\n    DeleteElementAction |\r\n    ClearAction;\r\n","import {ReactNode} from \"react\";\r\nimport {Dispatch} from \"redux\";\r\nimport {Point, SvgShape} from \"../models/svg\";\r\n\r\nexport enum ToolType {\r\n    CREATOR,\r\n    MANIPULATOR,\r\n}\r\n\r\nexport default abstract class Tool<T> {\r\n    public onClick(state: T, dispatch: Dispatch, e: Point): T {\r\n        return state;\r\n    }\r\n\r\n    public onMouseMove(state: T, dispatch: Dispatch, e: Point): T {\r\n        return state;\r\n    }\r\n\r\n    public onMouseLeave(state: T, dispatch: Dispatch, e: Point) {\r\n        return state;\r\n    }\r\n\r\n    public onShapeClick(state: T, dispatch: Dispatch, idx: number, shape: SvgShape): T {\r\n        return state;\r\n    }\r\n\r\n    public onFinish(state: T, dispatch: Dispatch): T {\r\n        return state;\r\n    }\r\n\r\n    public renderShape(state: T): ReactNode {\r\n        return null;\r\n    }\r\n\r\n    public toolType(): ToolType {\r\n        return ToolType.CREATOR;\r\n    }\r\n\r\n    public showHoverPoint(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public abstract getInitialState(): T;\r\n}\r\n\r\n","export enum SvgShapeType {\r\n    TYPE_CIRCLE = 'CIRCLE',\r\n    TYPE_LINE = 'LINE',\r\n    TYPE_POLYGON = 'POLYGON',\r\n    TYPE_POLYLINE = 'POLYLINE',\r\n}\r\n\r\nexport interface Point {\r\n    x: number;\r\n    y: number;\r\n}\r\n\r\nexport enum PropertyType {\r\n    INTEGER,\r\n    FLOAT,\r\n    POINT,\r\n    COLOR,\r\n}\r\n\r\nexport interface Property {\r\n    label: string;\r\n    type: PropertyType;\r\n    required?: boolean;\r\n}\r\n\r\nexport type Properties = {[key: string]: Property};\r\n\r\nexport const nextShapeId = (() => {\r\n    let lastId = 0;\r\n    return () => ++lastId;\r\n})()\r\n\r\nexport interface SvgShape {\r\n    type: SvgShapeType;\r\n    id: number;\r\n    [key: string]: any;\r\n}\r\n\r\ninterface WithStroke {\r\n    strokeWidth: number | null;\r\n    strokeColorId: number | null;\r\n}\r\n\r\nconst WithStrokeProperties: Properties = {\r\n    strokeWidth: {\r\n        label: 'Stroke width',\r\n        type: PropertyType.FLOAT\r\n    },\r\n    strokeColorId: {\r\n        label: 'Stroke color',\r\n        type: PropertyType.COLOR\r\n    }\r\n}\r\n\r\ninterface WithFill {\r\n    fillColorId: number | null;\r\n}\r\n\r\nconst WithFillProperties: Properties = {\r\n    fillColorId: {\r\n        label: 'Fill color',\r\n        type: PropertyType.COLOR\r\n    }\r\n}\r\n\r\nexport interface SvgCircle extends SvgShape, WithStroke, WithFill {\r\n    center: Point;\r\n    r: number;\r\n}\r\n\r\nexport const SvgCircleProperties: Properties = {\r\n    center: {\r\n        label: 'Center',\r\n        type: PropertyType.POINT,\r\n        required: true\r\n    },\r\n    r: {\r\n        label: 'Radius',\r\n        type: PropertyType.FLOAT,\r\n        required: true\r\n    },\r\n    ...WithFillProperties,\r\n    ...WithStrokeProperties\r\n}\r\n\r\nexport interface SvgLine extends SvgShape, WithStroke {\r\n    point1: Point;\r\n    point2: Point;\r\n}\r\n\r\nexport const SvgLineProperties: Properties = {\r\n    point1: {\r\n        label: 'Start point',\r\n        type: PropertyType.POINT,\r\n        required: true\r\n    },\r\n    point12: {\r\n        label: 'End point',\r\n        type: PropertyType.POINT,\r\n        required: true\r\n    },\r\n    ...WithStrokeProperties\r\n}\r\n\r\nexport interface SvgPolygon extends SvgShape, WithStroke, WithFill {\r\n    points: Point[];\r\n}\r\n\r\nexport const SvgPolygonProperties: Properties = {\r\n    ...WithStrokeProperties,\r\n    ...WithFillProperties\r\n}\r\n\r\nexport interface SvgPolyline extends SvgShape, WithStroke {\r\n    points: Point[];\r\n}\r\n\r\nexport const SvgPolylineProperties: Properties = WithStrokeProperties;\r\n\r\nexport const propertiesMap = {\r\n    [SvgShapeType.TYPE_LINE]: SvgLineProperties,\r\n    [SvgShapeType.TYPE_POLYGON]: SvgPolygonProperties,\r\n    [SvgShapeType.TYPE_POLYLINE]: SvgPolylineProperties,\r\n    [SvgShapeType.TYPE_CIRCLE]: SvgCircleProperties,\r\n}\r\n","import Tool, {ToolType} from \"./Tool\";\r\nimport {Dispatch} from \"redux\";\r\nimport {Point, SvgShape} from \"../models/svg\";\r\nimport {selectShape} from \"../actions/editor\";\r\n\r\nexport interface SelectState {\r\n\r\n}\r\n\r\nexport default class Select extends Tool<SelectState> {\r\n    onClick(state: SelectState, dispatch: Dispatch, e: Point): SelectState {\r\n        dispatch(selectShape(null));\r\n        return state;\r\n    }\r\n\r\n    onShapeClick(state: SelectState, dispatch: Dispatch, idx: number, shape: SvgShape): SelectState {\r\n        dispatch(selectShape(idx));\r\n        return state;\r\n    }\r\n\r\n    showHoverPoint(): boolean {\r\n        return false;\r\n    }\r\n\r\n    toolType(): ToolType {\r\n        return ToolType.MANIPULATOR;\r\n    }\r\n\r\n    getInitialState(): SelectState {\r\n        return {};\r\n    }\r\n}\r\n","import {ReactNode, useCallback, useEffect, useState} from \"react\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport Select from \"./Select\";\r\nimport Line from \"./Line\";\r\nimport Polyline from \"./Polyline\";\r\nimport Circle from \"./Circle\";\r\nimport Polygon from \"./Polygon\";\r\nimport {Point, SvgShape} from \"../models/svg\";\r\nimport Tool, {ToolType} from \"./Tool\";\r\n\r\nexport enum Tools {\r\n    SELECT,\r\n    LINE,\r\n    POLYLINE,\r\n    CIRCLE,\r\n    POLYGON,\r\n}\r\n\r\nconst toolMap = {\r\n    [Tools.SELECT]: new Select(),\r\n    [Tools.LINE]: new Line(),\r\n    [Tools.POLYLINE]: new Polyline(),\r\n    [Tools.CIRCLE]: new Circle(),\r\n    [Tools.POLYGON]: new Polygon(),\r\n}\r\n\r\ntype EditorEventHandler = (p: Point) => void;\r\n\r\ninterface ToolHook {\r\n    svgEventHandlers: {\r\n        onClick: EditorEventHandler,\r\n        onMouseMove: EditorEventHandler,\r\n        onMouseLeave: EditorEventHandler,\r\n        onFinish: () => void;\r\n    };\r\n    onShapeClick: (idx: number, shape: SvgShape) => void;\r\n    renderedShape: ReactNode;\r\n    showHoverPoint: boolean;\r\n    toolType: ToolType;\r\n}\r\n\r\nexport const useTool = (tool: Tools): ToolHook => {\r\n    const dispatch = useDispatch();\r\n    const [selectedTool, setSelectedTool] = useState<Tool<any>>(toolMap[tool]);\r\n    const [toolState, setToolState] = useState<any>(selectedTool.getInitialState());\r\n\r\n    useEffect(() => {\r\n        setSelectedTool(toolMap[tool]);\r\n        setToolState(toolMap[tool].getInitialState());\r\n    }, [tool]);\r\n\r\n    const onClick = useCallback((e: Point) => {\r\n        setToolState(selectedTool.onClick(toolState, dispatch, e));\r\n    }, [toolState, dispatch, setToolState, selectedTool]);\r\n\r\n    const onMouseMove = useCallback((e: Point) => {\r\n        setToolState(selectedTool.onMouseMove(toolState, dispatch, e));\r\n    }, [toolState, dispatch, setToolState, selectedTool]);\r\n\r\n    const onMouseLeave = useCallback((e: Point) => {\r\n        setToolState(selectedTool.onMouseLeave(toolState, dispatch, e));\r\n    }, [toolState, dispatch, setToolState, selectedTool]);\r\n\r\n    const onShapeClick = useCallback((idx, shape) => {\r\n        setToolState(selectedTool.onShapeClick(toolState, dispatch, idx, shape));\r\n    }, [toolState, dispatch, setToolState, selectedTool]);\r\n\r\n    const onFinish = useCallback(() => {\r\n        setToolState(selectedTool.onFinish(toolState, dispatch));\r\n    }, [toolState, dispatch, setToolState, selectedTool]);\r\n\r\n    return {\r\n        svgEventHandlers: {\r\n            onClick,\r\n            onMouseMove,\r\n            onMouseLeave,\r\n            onFinish,\r\n        },\r\n        onShapeClick,\r\n        renderedShape: selectedTool.renderShape(toolState),\r\n        showHoverPoint: selectedTool.showHoverPoint(),\r\n        toolType: selectedTool.toolType(),\r\n    }\r\n}\r\n","import {TheState} from \"../reducers\";\r\nimport {PaletteState} from \"../reducers/palette\";\r\n\r\nexport const colorSelector = (id: number | null) => (state: TheState) => id === null ? undefined : state.palette[id];\r\nexport const paletteSelector = (state: TheState): PaletteState => state.palette;\r\n","import React from \"react\";\r\nimport {SvgCircle, SvgLine, SvgPolygon, SvgPolyline, SvgShape, SvgShapeType} from \"../models/svg\";\r\nimport {useSelector} from \"react-redux\";\r\nimport {colorSelector} from \"../selectors/palette\";\r\n\r\ninterface RendererProps {\r\n    eventHandlers?: any;\r\n    selected?: boolean;\r\n}\r\n\r\nconst selectedColor = '#3298dc';\r\n\r\nconst SvgLineRenderer = (props: {line: SvgLine} & RendererProps) => {\r\n    const {line, selected} = props;\r\n\r\n    const color = useSelector(colorSelector(line.strokeColorId));\r\n    const actualColor = selected ? selectedColor : color;\r\n    return <line\r\n        x1={line.point1.x}\r\n        y1={line.point1.y}\r\n        x2={line.point2.x}\r\n        y2={line.point2.y}\r\n        stroke={actualColor ?? 'none'}\r\n        strokeWidth={line.strokeWidth ?? 0}\r\n        {...props.eventHandlers} />;\r\n}\r\n\r\nconst SvgPolylineRenderer = (props: {polyline: SvgPolyline} & RendererProps) => {\r\n    const {polyline, selected} = props;\r\n\r\n    const color = useSelector(colorSelector(polyline.strokeColorId));\r\n    const actualColor = selected ? selectedColor : color;\r\n    return <polyline\r\n        points={polyline.points.map(p => `${p.x},${p.y}`).join(' ')}\r\n        stroke={actualColor ?? 'none'}\r\n        strokeWidth={polyline.strokeWidth ?? 0}\r\n        fill=\"none\"\r\n        {...props.eventHandlers} />\r\n}\r\n\r\nconst SvgCircleRenderer = (props: {circle: SvgCircle} & RendererProps) => {\r\n    const {circle, selected} = props;\r\n\r\n    const color = useSelector(colorSelector(circle.fillColorId));\r\n    const actualColor = selected ? selectedColor : color;\r\n\r\n    const strokeColor = useSelector(colorSelector(circle.strokeColorId));\r\n\r\n    return <circle\r\n        cx={circle.center.x}\r\n        cy={circle.center.y}\r\n        r={circle.r}\r\n        fill={actualColor ?? 'none'}\r\n        stroke={strokeColor ?? 'none'}\r\n        strokeWidth={circle.strokeWidth ?? 0}\r\n        {...props.eventHandlers} />\r\n}\r\n\r\nconst SvgPolygonRenderer = (props: {polygon: SvgPolygon} & RendererProps) => {\r\n    const {polygon, selected} = props;\r\n\r\n    const color = useSelector(colorSelector(polygon.fillColorId));\r\n    const actualColor = selected ? selectedColor : color;\r\n\r\n    const strokeColor = useSelector(colorSelector(polygon.strokeColorId));\r\n\r\n    return <polygon\r\n        points={polygon.points.map(p => `${p.x},${p.y}`).join(' ')}\r\n        fill={actualColor ?? 'none'}\r\n        stroke={strokeColor ?? 'none'}\r\n        strokeWidth={polygon.strokeWidth ?? 0}\r\n        {...props.eventHandlers} />\r\n}\r\n\r\nconst SvgShapeRenderer = (props: {shape: SvgShape} & RendererProps) => {\r\n    const shape = props.shape;\r\n\r\n    switch (shape.type) {\r\n        case SvgShapeType.TYPE_LINE:\r\n            return <SvgLineRenderer line={shape as SvgLine} eventHandlers={props.eventHandlers} selected={props.selected} />\r\n        case SvgShapeType.TYPE_POLYLINE:\r\n            return <SvgPolylineRenderer polyline={shape as SvgPolyline} eventHandlers={props.eventHandlers} selected={props.selected} />\r\n        case SvgShapeType.TYPE_CIRCLE:\r\n            return <SvgCircleRenderer circle={shape as SvgCircle} eventHandlers={props.eventHandlers} selected={props.selected} />\r\n        case SvgShapeType.TYPE_POLYGON:\r\n            return <SvgPolygonRenderer polygon={shape as SvgPolygon} eventHandlers={props.eventHandlers} selected={props.selected} />\r\n        default:\r\n            return null;\r\n    }\r\n}\r\n\r\nexport default SvgShapeRenderer;\r\n","import Tool from \"./Tool\";\r\nimport {nextShapeId, Point, SvgLine, SvgShapeType} from \"../models/svg\";\r\nimport {Dispatch} from \"redux\";\r\nimport React from \"react\";\r\nimport {addShape} from \"../actions/editor\";\r\nimport SvgShapeRenderer from \"../components/SvgShapeRenderer\";\r\n\r\nexport type LineState = Partial<SvgLine>;\r\n\r\nexport default class Line extends Tool<LineState> {\r\n    onClick(state: LineState, dispatch: Dispatch, e: Point): LineState {\r\n        if (state.point1) {\r\n            dispatch(addShape({...state, id: nextShapeId()} as SvgLine));\r\n            return this.getInitialState();\r\n        }\r\n        return {...state, point1: e};\r\n    }\r\n\r\n    onMouseMove(state: LineState, dispatch: Dispatch, e: Point): LineState {\r\n        if (state.point1)\r\n            return {...state, point2: e};\r\n        return state;\r\n    }\r\n\r\n    renderShape(state: LineState): React.ReactNode {\r\n        if (state.point1 && state.point2) {\r\n            return <SvgShapeRenderer shape={state as SvgLine} />\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getInitialState(): LineState {\r\n        return {\r\n            type: SvgShapeType.TYPE_LINE,\r\n            zIndex: 0,\r\n            strokeColorId: 0,\r\n            strokeWidth: 2,\r\n        };\r\n    }\r\n}\r\n","import Tool from \"./Tool\";\r\nimport {nextShapeId, Point, SvgPolyline, SvgShapeType} from \"../models/svg\";\r\nimport {Dispatch} from \"redux\";\r\nimport React from \"react\";\r\nimport SvgShapeRenderer from \"../components/SvgShapeRenderer\";\r\nimport {addShape} from \"../actions/editor\";\r\n\r\nexport type PolylineState = SvgPolyline;\r\n\r\nexport default class Polyline extends Tool<PolylineState> {\r\n\r\n    onClick(state: PolylineState, dispatch: Dispatch, e: Point): PolylineState {\r\n        return {...state, points: state.points.concat(e)};\r\n    }\r\n\r\n    onMouseMove(state: PolylineState, dispatch: Dispatch, e: Point): PolylineState {\r\n        const points = [...state.points];\r\n        points.pop();\r\n        points.push(e);\r\n        return {...state, points};\r\n    }\r\n\r\n    onFinish(state: PolylineState, dispatch: Dispatch): PolylineState {\r\n        const points = [...state.points];\r\n        points.pop();\r\n        const shape = {...state, points, id: nextShapeId()} as SvgPolyline;\r\n        dispatch(addShape(shape));\r\n\r\n        return this.getInitialState();\r\n    }\r\n\r\n    renderShape(state: PolylineState): React.ReactNode {\r\n        return <SvgShapeRenderer shape={state as SvgPolyline} />\r\n    }\r\n\r\n    getInitialState(): PolylineState {\r\n        return {\r\n            type: SvgShapeType.TYPE_POLYLINE,\r\n            zIndex: 0,\r\n            strokeColorId: 0,\r\n            strokeWidth: 2,\r\n            points: [],\r\n            id: 0,\r\n        };\r\n    }\r\n}\r\n","import Tool from \"./Tool\";\r\nimport {nextShapeId, Point, SvgCircle, SvgShapeType} from \"../models/svg\";\r\nimport {Dispatch} from \"redux\";\r\nimport {addShape} from \"../actions/editor\";\r\nimport SvgShapeRenderer from \"../components/SvgShapeRenderer\";\r\nimport React from \"react\";\r\n\r\nexport type CircleState = Partial<SvgCircle>;\r\n\r\nexport default class Circle extends Tool<CircleState> {\r\n    onClick(state: CircleState, dispatch: Dispatch, e: Point): CircleState {\r\n        if (state.center) {\r\n            dispatch(addShape({...state, id: nextShapeId()} as SvgCircle));\r\n            return this.getInitialState();\r\n        }\r\n\r\n        return {...state, center: e};\r\n    }\r\n\r\n    onMouseMove(state: CircleState, dispatch: Dispatch, e: Point): CircleState {\r\n        if (state.center) {\r\n            return {...state, r: Circle.getDistance(state.center, e)};\r\n        }\r\n        return state;\r\n    }\r\n\r\n    renderShape(state: CircleState): React.ReactNode {\r\n        if (state.center && state.r)\r\n            return <SvgShapeRenderer shape={state as SvgCircle} />;\r\n        return null;\r\n    }\r\n\r\n    getInitialState(): CircleState {\r\n        return {\r\n            type: SvgShapeType.TYPE_CIRCLE,\r\n            zIndex: 0,\r\n            fillColorId: 0,\r\n            strokeWidth: null,\r\n            strokeColorId: null,\r\n        };\r\n    }\r\n\r\n    private static getDistance(p1: Point, p2: Point) {\r\n        const dx = p2.x - p1.x;\r\n        const dy = p2.y - p1.y;\r\n        return Math.sqrt(dx*dx + dy*dy);\r\n    }\r\n}\r\n","import Tool from \"./Tool\";\r\nimport {nextShapeId, Point, SvgPolygon, SvgShapeType} from \"../models/svg\";\r\nimport {Dispatch} from \"redux\";\r\nimport {addShape} from \"../actions/editor\";\r\nimport React from \"react\";\r\nimport SvgShapeRenderer from \"../components/SvgShapeRenderer\";\r\n\r\nexport type PolygonState = SvgPolygon;\r\n\r\nexport default class Polygon extends Tool<PolygonState> {\r\n    onClick(state: PolygonState, dispatch: Dispatch, e: Point): PolygonState {\r\n        if (state.points.length > 0 && e.x === state.points[0].x && e.y === state.points[0].y)\r\n            return this.onFinish(state, dispatch);\r\n        return {...state, points: state.points.concat([e, e])};\r\n    }\r\n\r\n    onMouseMove(state: PolygonState, dispatch: Dispatch, e: Point): PolygonState {\r\n        if (state.points.length === 0)\r\n            return state;\r\n\r\n        const points = [...state.points];\r\n        points.pop();\r\n        points.push(e);\r\n        return {...state, points};\r\n    }\r\n\r\n    onFinish(state: PolygonState, dispatch: Dispatch): PolygonState {\r\n        const points = [...state.points];\r\n        points.pop();\r\n        const shape = {...state, points, id: nextShapeId()} as SvgPolygon;\r\n        dispatch(addShape(shape));\r\n\r\n        return this.getInitialState();\r\n    }\r\n\r\n    renderShape(state: PolygonState): React.ReactNode {\r\n        return <SvgShapeRenderer shape={state as SvgPolygon} />\r\n    }\r\n    getInitialState(): PolygonState {\r\n        return {\r\n            type: SvgShapeType.TYPE_POLYGON,\r\n            zIndex: 0,\r\n            fillColorId: 0,\r\n            points: [],\r\n            strokeColorId: null,\r\n            strokeWidth: null,\r\n            id: 0\r\n        };\r\n    }\r\n}\r\n","import {TheState} from \"../reducers\";\r\nimport {SvgShape} from \"../models/svg\";\r\nimport {Tools} from \"../editor-tools\";\r\n\r\nexport const gridSizeSelector = (state: TheState): number => state.editor.gridSize;\r\nexport const elementsSelector = (state: TheState): SvgShape[] => state.editor.elements;\r\nexport const toolSelector = (state: TheState): Tools => state.editor.selectedTool;\r\nexport const selectedIdxSelector = (state: TheState): number | null => state.editor.selectedIdx;\r\nexport const shapeSelector = (idx: number) => (state: TheState): SvgShape => state.editor.elements[idx];\r\nexport const elementPropertySelector = (idx: number, prop: string) => (state: TheState): any => state.editor.elements[idx][prop];\r\n","import {Action} from \"redux\";\r\nimport Tile from \"../models/Tile\";\r\n\r\nexport const TILES_SET_TILE = 'TILES_SET_TILE';\r\nexport const TILES_DELETE_TILE = 'TILES_DELETE_TILE';\r\nexport const TILES_SET_TILES = 'TILES_SET_TILES';\r\n\r\nexport interface SetTileAction extends Action<typeof TILES_SET_TILE> {\r\n    tile: Tile\r\n}\r\n\r\nexport function setTile(tile: Tile): SetTileAction {\r\n    return {\r\n        type: TILES_SET_TILE,\r\n        tile\r\n    }\r\n}\r\n\r\nexport interface DeleteTileAction extends Action<typeof TILES_DELETE_TILE> {\r\n    id: number;\r\n}\r\n\r\nexport function deleteTile(id: number): DeleteTileAction {\r\n    return {\r\n        type: TILES_DELETE_TILE,\r\n        id\r\n    }\r\n}\r\n\r\nexport interface SetTilesAction extends Action<typeof TILES_SET_TILES> {\r\n    tiles: Tile[];\r\n}\r\n\r\nexport function setTiles(tiles: Tile[]): SetTilesAction {\r\n    return {\r\n        type: TILES_SET_TILES,\r\n        tiles\r\n    }\r\n}\r\n\r\nexport type TilesActions = SetTileAction | DeleteTileAction | SetTilesAction;\r\n","import Tile from \"../models/Tile\";\r\nimport {TILES_DELETE_TILE, TILES_SET_TILE, TILES_SET_TILES, TilesActions} from \"../actions/tiles\";\r\n\r\nexport const nextTileId = (() => {\r\n    let lastId = 0;\r\n    return () => ++lastId;\r\n})();\r\n\r\nexport type TilesState = Tile[];\r\n\r\nconst initialState: TilesState = [];\r\n\r\nexport function tiles(state = initialState, action: TilesActions): TilesState {\r\n    switch (action.type) {\r\n        case TILES_SET_TILE:\r\n            const tileIdx = state.findIndex(t => t.id === action.tile.id);\r\n            if (tileIdx >= 0) {\r\n                return state.map(t => t.id === action.tile.id ? {...action.tile} : t);\r\n            }\r\n            return [...state, action.tile];\r\n        case TILES_DELETE_TILE:\r\n            return state.filter(tile => tile.id !== action.id);\r\n        case TILES_SET_TILES:\r\n            return [...action.tiles];\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","import React, {useCallback} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectTool} from \"../actions/editor\";\r\nimport {Tools} from \"../editor-tools\";\r\nimport {elementsSelector, toolSelector} from \"../selectors/editor\";\r\nimport {setTile} from \"../actions/tiles\";\r\nimport {nextTileId} from \"../reducers/tiles\";\r\nimport {useHistory, useParams} from \"react-router-dom\";\r\n\r\nconst blk = bem('svg-editor');\r\n\r\nconst SvgToolbar = () => {\r\n    const dispatch = useDispatch();\r\n    const selectedTool = useSelector(toolSelector);\r\n    const elements = useSelector(elementsSelector);\r\n    const history = useHistory();\r\n\r\n    const params = useParams<{id: string}>();\r\n    const id = params.id ? parseInt(params.id) : null;\r\n\r\n    const handleSave = useCallback(() => {\r\n        dispatch(setTile({\r\n            id: id !== null ? id : nextTileId(),\r\n            elements\r\n        }));\r\n        history.push('/tiles');\r\n    }, [elements, dispatch, history, id]);\r\n\r\n    return (\r\n        <div className={blk('toolbar')}>\r\n            <button className=\"button\" onClick={handleSave}>Save</button>\r\n            <div className=\"buttons has-addons is-centered\">\r\n                <button className={\"button\" + (selectedTool === Tools.SELECT ? \" is-dark\" : \"\")} onClick={() => dispatch(selectTool(Tools.SELECT))}>Select</button>\r\n                <button className={\"button\" + (selectedTool === Tools.LINE ? \" is-dark\" : \"\")} onClick={() => dispatch(selectTool(Tools.LINE))}>Line</button>\r\n                <button className={\"button\" + (selectedTool === Tools.POLYLINE ? \" is-dark\" : \"\")} onClick={() => dispatch(selectTool(Tools.POLYLINE))}>Polyline</button>\r\n                <button className={\"button\" + (selectedTool === Tools.CIRCLE ? \" is-dark\" : \"\")} onClick={() => dispatch(selectTool(Tools.CIRCLE))}>Circle</button>\r\n                <button className={\"button\" + (selectedTool === Tools.POLYGON ? \" is-dark\" : \"\")} onClick={() => dispatch(selectTool(Tools.POLYGON))}>Polygon</button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SvgToolbar;\r\n","import React, {useCallback, useState} from \"react\";\r\n\r\ninterface Props {\r\n    onChange: (val: number | null) => void;\r\n    initialValue?: number | null;\r\n    required?: boolean;\r\n}\r\n\r\nconst IntegerControl = (props: Props) => {\r\n    const [value, setValue] = useState(props.initialValue);\r\n\r\n    const onChange = useCallback(e => {\r\n        const val = e.target.value;\r\n        if (val === '') {\r\n            if (props.required)\r\n                return;\r\n            setValue(null);\r\n            props.onChange(null);\r\n            return;\r\n        }\r\n\r\n        const i = parseInt(val);\r\n        setValue(i);\r\n        props.onChange(i);\r\n    }, [setValue, props.onChange, props.required]);\r\n\r\n    return (\r\n        <div className=\"control\">\r\n            <input type=\"number\" className=\"input\" onChange={onChange} value={value ?? ''} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default IntegerControl;\r\n","import React, {useCallback, useState} from \"react\";\r\n\r\ninterface Props {\r\n    onChange: (val: number | null) => void;\r\n    initialValue?: number | null;\r\n    required?: boolean;\r\n}\r\n\r\nconst FloatControl = (props: Props) => {\r\n    const [value, setValue] = useState(props.initialValue);\r\n\r\n    const onChange = useCallback(e => {\r\n        const val = e.target.value;\r\n        if (val === '') {\r\n            if (props.required)\r\n                return;\r\n            setValue(null);\r\n            props.onChange(null);\r\n            return;\r\n        }\r\n\r\n        setValue(val);\r\n        const i = parseFloat(e.target.value);\r\n        if (!isNaN(i)) {\r\n            props.onChange(i);\r\n        }\r\n    }, [setValue, props.onChange, props.required]);\r\n\r\n    return (\r\n        <div className=\"control\">\r\n            <input type=\"number\" className=\"input\" onChange={onChange} value={value ?? ''} step=\"0.1\" />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default FloatControl;\r\n","import React, {useCallback, useState} from \"react\";\r\nimport {Point} from \"../../models/svg\";\r\n\r\ninterface Props {\r\n    onChange: (val: Point) => void;\r\n    initialValue?: Point;\r\n    required?: boolean;\r\n}\r\n\r\nconst PointControl = (props: Props) => {\r\n    const [value, setValue] = useState(props.initialValue);\r\n\r\n    const onChange = useCallback(e => {\r\n        const prop = e.target.name;\r\n        const val = e.target.value ?? null;\r\n\r\n        if (val === null && props.required)\r\n            return;\r\n\r\n        setValue({...value, [prop]:  val} as Point);\r\n        const i = parseFloat(e.target.value);\r\n        const newVal = val === null ? val : i;\r\n        if (!isNaN(newVal)) {\r\n            props.onChange({...value, [prop]: newVal} as Point);\r\n        }\r\n    }, [value, setValue, props.onChange, props.required]);\r\n\r\n    return (\r\n        <div className=\"control\">\r\n            <div className=\"columns\">\r\n                <div className=\"column\">\r\n                    <span>X</span>\r\n                    <input type=\"number\" className=\"input\" name=\"x\" onChange={onChange} value={value?.x ?? ''} />\r\n                </div>\r\n                <div className=\"column\">\r\n                    <span>Y</span>\r\n                    <input type=\"number\" className=\"input\" name=\"y\" onChange={onChange} value={value?.y ?? ''} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default PointControl;\r\n","import {PaletteActions} from \"../actions/palette\";\r\n\r\nexport type Color = string;\r\n\r\nexport interface PaletteState {\r\n    [id: number]: Color\r\n}\r\n\r\nexport const defaultColor = '#000';\r\n\r\nconst initialState: PaletteState = {\r\n    0: defaultColor\r\n}\r\n\r\nexport const nextId = (() => {\r\n    let lastId = 0;\r\n    return () => ++lastId;\r\n})();\r\n\r\nexport function palette(state = initialState, action: PaletteActions): PaletteState {\r\n    switch (action.type) {\r\n        case \"PALETTE_ADD_COLOR\":\r\n            return {...state, [action.id]: action.color};\r\n        case \"PALETTE_REMOVE_COLOR\":\r\n            const {[action.id]: toRemove, ...newState} = state;\r\n            return newState;\r\n        case \"PALETTE_UPDATE_COLOR\":\r\n            return {...state, [action.id]: action.color};\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","import React, {useCallback, useEffect, useRef, useState} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {paletteSelector} from \"../../selectors/palette\";\r\nimport {addColor, removeColor, updateColor} from \"../../actions/palette\";\r\nimport { ChromePicker } from 'react-color'\r\nimport {defaultColor, nextId} from \"../../reducers/palette\";\r\n\r\n\r\nconst blk = bem('palette-picker');\r\n\r\nconst NoColorSvg = () => (\r\n    <svg viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\" className={blk('colornone')}>\r\n        <polyline points=\"0,0 100,0 100,100 0,100 0,0\" stroke=\"#000\" strokeWidth=\"2\" fill=\"none\" />\r\n        <line x1=\"100\" y1=\"0\" x2=\"0\" y2=\"100\" stroke=\"#000\" strokeWidth=\"2\" />\r\n        <line x1=\"0\" y1=\"0\" x2=\"100\" y2=\"100\" stroke=\"#000\" strokeWidth=\"2\" />\r\n    </svg>\r\n);\r\n\r\ninterface PickerItemProps {\r\n    id: number | null,\r\n    color?: string,\r\n    canEdit?: boolean,\r\n    onDelete?: (id: number) => void,\r\n    onSelect?: (id: number | null) => void,\r\n    selected?: boolean;\r\n    ref?: (ref: any) => void;\r\n}\r\n\r\nconst PickerItem = React.forwardRef((props: PickerItemProps, ref: any) => {\r\n    const { id, color, canEdit, onDelete, onSelect, selected } = props;\r\n    const [editOpen, setEditOpen] = useState(false);\r\n    const dispatch = useDispatch();\r\n\r\n    const openEdit = useCallback(() => {\r\n        setEditOpen(true);\r\n    }, [setEditOpen]);\r\n\r\n    const closeEdit = useCallback(() => {\r\n        setEditOpen(false);\r\n    }, [setEditOpen]);\r\n\r\n    const handleEdit = useCallback((color) => {\r\n        dispatch(updateColor(id as number, color.hex));\r\n    }, [dispatch, id]);\r\n\r\n    return (\r\n        <div ref={ref} onClick={() => onSelect && onSelect(id)} className={blk('item', selected ? ['active'] : [])}>\r\n            <div className={blk('info')}>\r\n                <span className={blk('thumb')} style={{backgroundColor: color}}>\r\n                    {!color && <NoColorSvg />}\r\n                </span>\r\n                <span className={blk('label')}>{color ?? 'None'}</span>\r\n            </div>\r\n            {typeof id === 'number' && <div className={blk('actions')}>\r\n                {canEdit && <button onClick={openEdit} className={blk('action', ['edit'])}>\r\n                    <span className=\"icon\">\r\n                        <i className=\"fas fa-pen\" />\r\n                    </span>\r\n                </button>}\r\n                {onDelete && <button onClick={() => onDelete(id)} className={blk('action', ['delete'])}>\r\n                    <span className=\"icon\">\r\n                        <i className=\"fas fa-trash\" />\r\n                    </span>\r\n                </button>}\r\n            </div>}\r\n            {editOpen && <div className={blk('popover')}>\r\n                <div className={blk('overlay')} onClick={closeEdit} />\r\n                <ChromePicker color={color} onChangeComplete={handleEdit} />\r\n            </div>}\r\n        </div>\r\n    )\r\n})\r\n\r\ninterface Props {\r\n    initialValue?: number | null;\r\n    onChange: (id: number | null) => void;\r\n    required?: boolean;\r\n}\r\n\r\n\r\nconst PalettePickerControl = (props: Props) => {\r\n    const [value, setValue] = useState(props.initialValue);\r\n    const palette = useSelector(paletteSelector);\r\n    const ids = Object.keys(palette).map(k => parseInt(k, 10));\r\n    const selectedRef = useRef();\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSelection = useCallback((id: number | null) => {\r\n        setValue(id);\r\n        props.onChange(id);\r\n    }, [setValue, props.onChange]);\r\n\r\n    const handleDelete = useCallback((id: number | null) => {\r\n        dispatch(removeColor(id as number));\r\n    }, [dispatch]);\r\n\r\n    const handleAddColor = useCallback(() => {\r\n        dispatch(addColor(nextId(), defaultColor));\r\n    }, [dispatch]);\r\n\r\n    useEffect(() => {\r\n        (selectedRef.current as any)?.scrollIntoView();\r\n    }, []);\r\n\r\n    return (\r\n        <div className={blk()}>\r\n            <div className={blk('input')}>\r\n                {!props.required && <PickerItem id={null} onSelect={handleSelection} selected={value === null} />}\r\n                {ids.map(id => (\r\n                    <PickerItem id={id} key={id} color={palette[id]}\r\n                                canEdit\r\n                                onDelete={id === 0 ? undefined : handleDelete}\r\n                                onSelect={handleSelection}\r\n                                selected={value === id}\r\n                                ref={value === id ? selectedRef : undefined}\r\n                    />\r\n                ))}\r\n\r\n                <div onClick={handleAddColor} className={blk('item', ['new'])}>\r\n                    <span className=\"icon\">\r\n                        <i className=\"fas fa-plus\" />\r\n                    </span>\r\n                    Add color\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PalettePickerControl;\r\n","import {Action} from \"redux\";\r\nimport {Color} from \"../reducers/palette\";\r\n\r\nexport const PALETTE_ADD_COLOR = 'PALETTE_ADD_COLOR';\r\nexport const PALETTE_REMOVE_COLOR = 'PALETTE_REMOVE_COLOR';\r\nexport const PALETTE_UPDATE_COLOR = 'PALETTE_UPDATE_COLOR';\r\n\r\nexport interface AddColorAction extends Action<typeof PALETTE_ADD_COLOR> {\r\n    id: number;\r\n    color: Color;\r\n}\r\n\r\nexport function addColor(id: number, color: Color): AddColorAction {\r\n    return {\r\n        type: PALETTE_ADD_COLOR,\r\n        id,\r\n        color\r\n    }\r\n}\r\n\r\nexport interface RemoveColorAction extends Action<typeof PALETTE_REMOVE_COLOR> {\r\n    id: number;\r\n}\r\n\r\nexport function removeColor(id: number): RemoveColorAction {\r\n    return {\r\n        type: PALETTE_REMOVE_COLOR,\r\n        id\r\n    }\r\n}\r\n\r\nexport interface UpdateColorAction extends Action<typeof PALETTE_UPDATE_COLOR> {\r\n    id: number;\r\n    color: Color;\r\n}\r\n\r\nexport function updateColor(id: number, color: Color): UpdateColorAction {\r\n    return {\r\n        type: PALETTE_UPDATE_COLOR,\r\n        id,\r\n        color\r\n    }\r\n}\r\n\r\nexport type PaletteActions = AddColorAction | RemoveColorAction | UpdateColorAction;\r\n","import React, {ReactNode} from \"react\";\r\nimport bem from \"bem-ts\";\r\n\r\nconst blk = bem('scrollable');\r\n\r\nconst Scrollable = (props: {children: ReactNode}) => (\r\n    <div className={blk()}>\r\n        <div className={blk('content')}>\r\n            {props.children}\r\n        </div>\r\n    </div>\r\n)\r\n\r\nexport default Scrollable;\r\n","import React, {useCallback} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectedIdxSelector, shapeSelector} from \"../selectors/editor\";\r\nimport {Properties, propertiesMap, Property, PropertyType} from \"../models/svg\";\r\nimport IntegerControl from \"./controls/IntegerControl\";\r\nimport {elemPropChange} from \"../actions/editor\";\r\nimport FloatControl from \"./controls/FloatControl\";\r\nimport PointControl from \"./controls/PointControl\";\r\nimport PalettePickerControl from \"./controls/PalettePickerControl\";\r\nimport Scrollable from \"./Scrollable\";\r\n\r\n\r\nconst blk = bem('svg-properties');\r\n\r\nconst PropertyInput = (props: {property: Property, propName: string, initialValue: any, shapeIdx: number}) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const changeHandler = useCallback((value: any) => {\r\n        dispatch(elemPropChange(props.shapeIdx, props.propName, value));\r\n    }, [props.shapeIdx, props.propName, dispatch]);\r\n\r\n    const ResolveControl = useCallback(({initialValue, onChange, required}) => {\r\n        switch (props.property.type) {\r\n            case PropertyType.INTEGER:\r\n                return <IntegerControl initialValue={initialValue} onChange={onChange} required={required} />\r\n            case PropertyType.FLOAT:\r\n                return <FloatControl initialValue={initialValue} onChange={onChange} required={required} />\r\n            case PropertyType.POINT:\r\n                return <PointControl initialValue={initialValue} onChange={onChange} required={required} />\r\n            case PropertyType.COLOR:\r\n                return <PalettePickerControl initialValue={initialValue} onChange={onChange} required={required} />\r\n            default:\r\n                return null;\r\n        }\r\n    }, [props.property.type, props.shapeIdx]);\r\n\r\n    return (\r\n        <div className=\"field\">\r\n            <label className=\"label\">\r\n                {props.property.label}\r\n            </label>\r\n            <ResolveControl initialValue={props.initialValue} onChange={changeHandler} />\r\n        </div>\r\n    )\r\n}\r\n\r\nconst PropertiesEditor = (props: {shapeIdx: number}) => {\r\n    const shape = useSelector(shapeSelector(props.shapeIdx));\r\n    if (!shape) return null;\r\n\r\n    const propertyTypes: Properties = propertiesMap[shape.type];\r\n    const properties = Object.keys(propertyTypes);\r\n\r\n    return (\r\n        <div>\r\n            {properties.map(prop =>\r\n                <PropertyInput\r\n                    key={prop}\r\n                    property={propertyTypes[prop]}\r\n                    propName={prop}\r\n                    initialValue={shape[prop]}\r\n                    shapeIdx={props.shapeIdx} />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nconst SvgPropertyEditor = () => {\r\n    const selectedIdx = useSelector(selectedIdxSelector);\r\n\r\n    return (\r\n        <div className={blk()}>\r\n            <Scrollable>\r\n                <h2 className={\"title \" + blk('title')}>Properties</h2>\r\n\r\n                {selectedIdx === null ?\r\n                    <p className={blk('text', ['unselected'])}>No shape selected</p>\r\n                    :\r\n                    <PropertiesEditor shapeIdx={selectedIdx} />\r\n                }\r\n            </Scrollable>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SvgPropertyEditor;\r\n","import React, {EventHandler, ReactNode, SyntheticEvent} from \"react\";\r\n\r\ninterface Props {\r\n    svgRef?: (el: SVGSVGElement) => void;\r\n    blk: (element: string) => string;\r\n    eventHandlers?: {\r\n        onClick?: EventHandler<SyntheticEvent>;\r\n        onMouseMove?: EventHandler<SyntheticEvent>;\r\n        onMouseLeave?: EventHandler<SyntheticEvent>;\r\n        onContextMenu?: EventHandler<SyntheticEvent>;\r\n    };\r\n    children?: ReactNode;\r\n    overlay?: ReactNode;\r\n}\r\n\r\nconst SvgCanvas = (props: Props) => {\r\n    return (\r\n        <svg ref={props.svgRef} viewBox=\"0 0 100 100\" className={props.blk('svg')} {...props.eventHandlers}>\r\n            {props.children}\r\n            {props.overlay && <g className=\"no-pointer-events\">\r\n                {props.overlay}\r\n            </g>}\r\n        </svg>\r\n    )\r\n}\r\n\r\nexport default SvgCanvas;\r\n","import React from \"react\";\r\n\r\ninterface Props {\r\n    gridSize: number;\r\n}\r\n\r\nconst SvgGrid = (props: Props) => {\r\n    const gridLinesCount = 100/props.gridSize + 1;\r\n    const grid = props.gridSize;\r\n    const lines = Array(gridLinesCount).fill(0);\r\n    return (\r\n        <>\r\n            {lines.map((_, idx) =>\r\n                <line key={idx} x1={0} y1={idx * grid} x2={100} y2={idx * grid} stroke=\"#999\" strokeOpacity={0.5}\r\n                      strokeWidth={1} vectorEffect=\"non-scaling-stroke\"/>\r\n            )}\r\n            {lines.map((_, idx) =>\r\n                <line key={idx} y1={0} x1={idx * grid} y2={100} x2={idx * grid} stroke=\"#999\" strokeOpacity={0.5}\r\n                        strokeWidth={1} vectorEffect=\"non-scaling-stroke\"/>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default SvgGrid;\r\n","import {TheState} from \"../reducers\";\r\nimport Tile from \"../models/Tile\";\r\n\r\nexport const tilesSelector = (state: TheState): Tile[] => state.tiles;\r\nexport const tileSelector = (id: number | null) => (state: TheState): Tile | undefined => state.tiles.find(t => t.id === id);\r\n","import React, {SyntheticEvent, useCallback, useEffect, useState} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport SvgCanvas from \"./SvgCanvas\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {elementsSelector, gridSizeSelector, selectedIdxSelector, toolSelector} from \"../selectors/editor\";\r\nimport SvgGrid from \"./SvgGrid\";\r\nimport {Point} from \"../models/svg\";\r\nimport {useTool} from \"../editor-tools\";\r\nimport SvgShapeRenderer from \"./SvgShapeRenderer\";\r\nimport {ToolType} from \"../editor-tools/Tool\";\r\nimport {clear, setElements} from \"../actions/editor\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport {tileSelector} from \"../selectors/tiles\";\r\n\r\nconst blk = bem('svg-editor');\r\n\r\nconst useSvgUtils: () => [(el: SVGSVGElement) => void, (e: SyntheticEvent, grid: number) => Point] = () => {\r\n    const [svg, setSvgRef] = useState(null);\r\n    const [svgPoint, setSvgPoint] = useState(null);\r\n    const ref = useCallback(el => {\r\n        if (el !== null) {\r\n            setSvgRef(el);\r\n            setSvgPoint(el.createSVGPoint());\r\n        }\r\n    }, [setSvgRef]);\r\n\r\n    const eventToSvgCoords = useCallback<(e: SyntheticEvent, grid: number) => Point>((e, grid): Point => {\r\n        if (svgPoint === null)\r\n            return {x: 0, y: 0};\r\n        // @ts-ignore\r\n        svgPoint.x = e.clientX;\r\n        // @ts-ignore\r\n        svgPoint.y = e.clientY;\r\n\r\n        // @ts-ignore\r\n        const transformed = svgPoint.matrixTransform(svg.getScreenCTM()?.inverse());\r\n        return {\r\n            x: Math.round(transformed.x / grid) * grid,\r\n            y: Math.round(transformed.y / grid) * grid,\r\n        };\r\n    }, [svgPoint, svg]);\r\n\r\n    return [ref, eventToSvgCoords];\r\n}\r\n\r\nconst SvgEditorCanvas = () => {\r\n    const [svgRef, eventToSvgCoords] = useSvgUtils();\r\n    const grid = useSelector(gridSizeSelector);\r\n    const selectedTool = useSelector(toolSelector);\r\n    const selectedIdx = useSelector(selectedIdxSelector);\r\n    const elements = useSelector(elementsSelector);\r\n    const [hoverPoint, setHoverPoint] = useState<{x: number, y: number} | null>(null);\r\n    const tool = useTool(selectedTool);\r\n    const dispatch = useDispatch();\r\n\r\n    const params = useParams<{id: string}>();\r\n    const id = params.id ? parseInt(params.id) : null;\r\n    const tile = useSelector(tileSelector(id));\r\n\r\n    const handleClick = useCallback((e) => {\r\n        const point = eventToSvgCoords(e, grid);\r\n        tool.svgEventHandlers.onClick(point);\r\n    }, [eventToSvgCoords, grid, tool.svgEventHandlers.onClick]);\r\n\r\n    const handleMouseMove = useCallback(e => {\r\n        const point = eventToSvgCoords(e, grid);\r\n        setHoverPoint(point);\r\n    }, [grid, eventToSvgCoords]);\r\n\r\n    const handleMouseExit = useCallback(e => {\r\n        setHoverPoint(null);\r\n        tool.svgEventHandlers.onMouseLeave(eventToSvgCoords(e, grid));\r\n    }, [setHoverPoint, eventToSvgCoords, grid, tool.svgEventHandlers.onMouseLeave]);\r\n\r\n    const handleShapeClick = useCallback((e: SyntheticEvent, idx) => {\r\n        if (tool.toolType === ToolType.MANIPULATOR) {\r\n            e.stopPropagation();\r\n            tool.onShapeClick(idx, elements[idx]);\r\n        }\r\n    }, [tool.onShapeClick, elements]);\r\n\r\n    const handleContextMenu = useCallback((e: SyntheticEvent) => {\r\n        e.preventDefault();\r\n        tool.svgEventHandlers.onFinish();\r\n    }, [tool.svgEventHandlers.onFinish]);\r\n\r\n    useEffect(() => {\r\n        hoverPoint && tool.svgEventHandlers.onMouseMove(hoverPoint);\r\n    }, [hoverPoint]);\r\n\r\n    useEffect(() => {\r\n        dispatch(clear());\r\n        if (id !== null && tile) {\r\n            dispatch(setElements(tile.elements));\r\n        }\r\n    }, [id, tile, dispatch]);\r\n\r\n    return (\r\n        <SvgCanvas svgRef={svgRef} blk={blk}\r\n                   eventHandlers={{\r\n                       onClick: handleClick,\r\n                       onMouseMove: handleMouseMove,\r\n                       onMouseLeave: handleMouseExit,\r\n                       onContextMenu: handleContextMenu\r\n                   }}\r\n                   overlay={\r\n                       <>\r\n                           <SvgGrid gridSize={grid} />\r\n                           {hoverPoint && tool.showHoverPoint &&\r\n                           <circle cx={hoverPoint.x} cy={hoverPoint.y} r={1} stroke=\"black\" strokeWidth={2}\r\n                                   vectorEffect=\"non-scaling-stroke\"/>}\r\n                       </>\r\n                   }\r\n        >\r\n            {elements.map((el, idx) => <SvgShapeRenderer key={el.id} selected={idx === selectedIdx} shape={el} eventHandlers={{onClick: (e: SyntheticEvent) => handleShapeClick(e, idx)}} />)}\r\n            {tool.renderedShape}\r\n        </SvgCanvas>\r\n    )\r\n}\r\n\r\nexport default SvgEditorCanvas;\r\n","export function reorder<T>(list: T[], startIndex: number, endIndex: number): T[] {\r\n    const result = Array.from(list);\r\n    const [removed] = result.splice(startIndex, 1);\r\n    result.splice(endIndex, 0, removed);\r\n\r\n    return result;\r\n}\r\n","import React, {SyntheticEvent, useCallback} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {elementsSelector, selectedIdxSelector} from \"../selectors/editor\";\r\nimport SvgCanvas from \"./SvgCanvas\";\r\nimport SvgShapeRenderer from \"./SvgShapeRenderer\";\r\nimport {SvgShape, SvgShapeType} from \"../models/svg\";\r\nimport Scrollable from \"./Scrollable\";\r\nimport {deleteElement, selectShape, setElements} from \"../actions/editor\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport {reorder} from \"../utils\";\r\n\r\nconst blk = bem('svg-element-viewer');\r\n\r\nconst shapeToLabel = (shape: SvgShape): string => {\r\n    let type = 'Unknown';\r\n\r\n    switch (shape.type) {\r\n        case SvgShapeType.TYPE_POLYGON:\r\n            type = 'Polygon';\r\n            break;\r\n        case SvgShapeType.TYPE_CIRCLE:\r\n            type = 'Circle';\r\n            break;\r\n        case SvgShapeType.TYPE_POLYLINE:\r\n            type = 'Polyline';\r\n            break;\r\n        case SvgShapeType.TYPE_LINE:\r\n            type = 'Line';\r\n            break;\r\n    }\r\n\r\n    return `${type} #${shape.id}`;\r\n}\r\n\r\nconst SvgElementViewer = () => {\r\n    const elements = useSelector(elementsSelector);\r\n    const selectedIdx = useSelector(selectedIdxSelector);\r\n    const dispatch = useDispatch();\r\n\r\n    const handleSelect = useCallback((e: SyntheticEvent, idx: number) => {\r\n        e.stopPropagation();\r\n        dispatch(selectShape(elements.length - idx - 1));\r\n    }, [dispatch, elements]);\r\n\r\n    const handleDragEnd = useCallback((result) => {\r\n        if (!result.destination) {\r\n            return;\r\n        }\r\n        dispatch(setElements(reorder(\r\n            elements,\r\n            elements.length - result.source.index - 1,\r\n            elements.length - result.destination.index - 1\r\n        )));\r\n    }, [elements, dispatch]);\r\n\r\n    const handleDelete = useCallback((e: SyntheticEvent, id: number) => {\r\n        e.stopPropagation();\r\n        dispatch(deleteElement(id));\r\n    }, [dispatch]);\r\n\r\n    const handleDeselect = useCallback(() => {\r\n        dispatch(selectShape(null));\r\n    }, [dispatch]);\r\n\r\n    const elementsReversed = [...elements];\r\n    elementsReversed.reverse();\r\n\r\n    return (\r\n        <DragDropContext onDragEnd={handleDragEnd}>\r\n            <div className={blk()} onClick={handleDeselect}>\r\n                <Scrollable>\r\n                    <div className={blk('content')}>\r\n                        <h2 className=\"title\">Elements</h2>\r\n                        <Droppable droppableId=\"elements\">\r\n                            {((provided, snapshot) => (\r\n                                <div\r\n                                    {...provided.droppableProps}\r\n                                    ref={provided.innerRef}\r\n                                    className={blk('items')}\r\n                                >\r\n                                    {elementsReversed.map((el, idx) =>\r\n                                        <Draggable draggableId={el.id.toString()} index={idx} key={el.id}>\r\n                                            {(innerProvided) => (\r\n                                                <div\r\n                                                    key={el.id}\r\n                                                    onClick={(e) => handleSelect(e, idx)}\r\n                                                    className={blk('item', selectedIdx ===  elements.length - idx - 1 ? ['active'] : [])}\r\n                                                    {...innerProvided.draggableProps}\r\n                                                    {...innerProvided.dragHandleProps}\r\n                                                    ref={innerProvided.innerRef}\r\n                                                >\r\n                                                    <div className={blk('info')}>\r\n                                                        <div className={blk('thumb')}>\r\n                                                            <SvgCanvas blk={blk}>\r\n                                                                <SvgShapeRenderer shape={el} />\r\n                                                            </SvgCanvas>\r\n                                                        </div>\r\n                                                        <div className={blk('label')}>\r\n                                                            {shapeToLabel(el)}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className={blk('actions')}>\r\n                                                        <button onClick={(e) => handleDelete(e, el.id)} className={blk('action', ['delete'])}>\r\n                                                            <span className=\"icon\">\r\n                                                                <i className=\"fas fa-trash\" />\r\n                                                            </span>\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </Draggable>\r\n                                    )}\r\n                                    {provided.placeholder}\r\n                                </div>\r\n                            ))}\r\n                        </Droppable>\r\n                    </div>\r\n                </Scrollable>\r\n            </div>\r\n        </DragDropContext>\r\n    )\r\n}\r\n\r\nexport default SvgElementViewer;\r\n","import React from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport PanelLayout from \"../layouts/PanelLayout\";\r\nimport SvgToolbar from \"./SvgToolbar\";\r\nimport SvgPropertyEditor from \"./SvgPropertyEditor\";\r\nimport SvgEditorCanvas from \"./SvgEditorCanvas\";\r\nimport SvgElementViewer from \"./SvgElementViewer\";\r\n\r\nconst blk = bem('svg-editor');\r\n\r\nconst SvgEditor = () => {\r\n    return (\r\n        <div className={blk()}>\r\n            <PanelLayout horizontal left={<SvgElementViewer />} right={<SvgPropertyEditor />}>\r\n                <PanelLayout left={<SvgToolbar />}>\r\n                    <div className={blk('wrap')}>\r\n                        <SvgEditorCanvas />\r\n                    </div>\r\n                </PanelLayout>\r\n            </PanelLayout>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SvgEditor;\r\n","import FullscreenPageLayout from \"layouts/FullscreenPageLayout\";\r\nimport React from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport Footer from \"../../components/Footer\";\r\nimport SvgEditor from \"../../components/SvgEditor\";\r\n\r\nconst TileEditor = () => {\r\n    return (\r\n        <FullscreenPageLayout header={<Navbar />} footer={<Footer />}>\r\n            <SvgEditor />\r\n        </FullscreenPageLayout>\r\n    );\r\n}\r\n\r\nexport default TileEditor;\r\n","import React from \"react\";\r\nimport FullscreenPageLayout from \"layouts/FullscreenPageLayout\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport Footer from \"../../components/Footer\";\r\n\r\nconst Generator = () => {\r\n    return (\r\n        <FullscreenPageLayout header={<Navbar />} footer={<Footer />}>\r\n            <h1>Generator</h1>\r\n        </FullscreenPageLayout>\r\n    )\r\n}\r\n\r\nexport default Generator;\r\n","import Tile from \"../../models/Tile\";\r\nimport React, {useCallback} from \"react\";\r\nimport bem from \"bem-ts\";\r\nimport SvgCanvas from \"../../components/SvgCanvas\";\r\nimport SvgShapeRenderer from \"../../components/SvgShapeRenderer\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport {deleteTile} from \"../../actions/tiles\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst blk = bem('tile-item');\r\n\r\nconst TileItem = (props: {tile: Tile, idx: number}) => {\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const handleEdit = useCallback(() => {\r\n        history.push(`/tiles/${props.tile.id}`);\r\n    }, [props.tile, history]);\r\n\r\n    const handleDelete = useCallback(() => {\r\n        dispatch(deleteTile(props.tile.id));\r\n    }, [props.tile, dispatch]);\r\n\r\n    return (\r\n        <div className={blk()}>\r\n            <div className={blk('thumb')}>\r\n                <SvgCanvas blk={blk}>\r\n                    {props.tile.elements.map(el => <SvgShapeRenderer key={el.id} shape={el} />)}\r\n                </SvgCanvas>\r\n                <div className={blk('actions')}>\r\n                    <button onClick={handleEdit} className={blk('action', ['edit'])}>\r\n                        <span className=\"icon\">\r\n                            <i className=\"fas fa-pen\" />\r\n                        </span>\r\n                    </button>\r\n                    <button onClick={handleDelete} className={blk('action', ['delete'])}>\r\n                        <span className=\"icon\">\r\n                            <i className=\"fas fa-trash\" />\r\n                        </span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            <div className={blk('label')}>\r\n                <span className=\"has-text-grey\">idx: {props.idx}</span>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport const NewTileItem = ({onClick}: {onClick: () => void}) => (\r\n    <div onClick={onClick} className={blk(['new'])}>\r\n        <span className=\"icon\"><i className=\"fas fa-plus fa-2x\" /></span>\r\n    </div>\r\n);\r\n\r\nexport default TileItem;\r\n","import FullscreenPageLayout from \"layouts/FullscreenPageLayout\";\r\nimport React, {useCallback} from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport Footer from \"../../components/Footer\";\r\nimport bem from \"bem-ts\";\r\nimport {useSelector} from \"react-redux\";\r\nimport {tilesSelector} from \"../../selectors/tiles\";\r\nimport Scrollable from \"../../components/Scrollable\";\r\nimport TileItem, {NewTileItem} from \"./TileItem\";\r\nimport {NavLink, useHistory} from \"react-router-dom\";\r\n\r\nconst blk = bem('tiles');\r\n\r\n\r\nconst Tiles = () => {\r\n    const tiles = useSelector(tilesSelector);\r\n    const history = useHistory();\r\n\r\n    const handleAddNew = useCallback(() => {\r\n        history.push('/tiles/new');\r\n    }, [history]);\r\n\r\n    return (\r\n        <FullscreenPageLayout header={<Navbar />} footer={<Footer />}>\r\n            <Scrollable>\r\n                <div className={blk()}>\r\n                    <div className={blk('heading')}>\r\n                        <h1 className=\"title\">Tiles</h1>\r\n                        <p className={blk('actions')}>\r\n                            <NavLink to=\"/tiles/reorder\">Reorder</NavLink>\r\n                        </p>\r\n                    </div>\r\n                    <div className={blk('items')}>\r\n                        {tiles.map((tile, idx) => <TileItem key={tile.id} idx={idx} tile={tile} />)}\r\n                        <NewTileItem onClick={handleAddNew} />\r\n                    </div>\r\n                </div>\r\n            </Scrollable>\r\n        </FullscreenPageLayout>\r\n    );\r\n}\r\n\r\nexport default Tiles;\r\n","import React, {useCallback} from \"react\";\r\nimport FullscreenPageLayout from \"../../layouts/FullscreenPageLayout\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport Footer from \"../../components/Footer\";\r\nimport bem from \"bem-ts\";\r\nimport Scrollable from \"../../components/Scrollable\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {tilesSelector} from \"../../selectors/tiles\";\r\nimport SvgCanvas from \"../../components/SvgCanvas\";\r\nimport SvgShapeRenderer from \"../../components/SvgShapeRenderer\";\r\nimport {setTiles} from \"../../actions/tiles\";\r\nimport {reorder} from \"../../utils\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nconst blk = bem('reorder');\r\n\r\n\r\nconst Reorder = () => {\r\n    const tiles = useSelector(tilesSelector);\r\n    const dispatch = useDispatch();\r\n\r\n    const handleDragEnd = useCallback((result) => {\r\n        if (!result.destination) {\r\n            return;\r\n        }\r\n        dispatch(setTiles(reorder(\r\n            tiles,\r\n            result.source.index,\r\n            result.destination.index\r\n        )));\r\n    }, [tiles, dispatch]);\r\n\r\n    return (\r\n        <FullscreenPageLayout header={<Navbar />} footer={<Footer />}>\r\n            <Scrollable>\r\n                <DragDropContext onDragEnd={handleDragEnd}>\r\n                    <div className={blk()}>\r\n                        <div className={blk('heading')}>\r\n                            <h1 className=\"title\">Reorder tiles</h1>\r\n                            <p className={blk('actions')}>\r\n                                <NavLink to=\"/tiles\">Back</NavLink>\r\n                            </p>\r\n                        </div>\r\n                        <p className=\"subtitle\">Reorder tiles by drag & drop</p>\r\n                        <div className={blk('columns')}>\r\n                            <div className={blk('col', ['idx'])}>\r\n                                {tiles.map((_, idx) => (\r\n                                    <div className={blk('item', ['idx'])}>{idx}</div>\r\n                                ))}\r\n                            </div>\r\n                            <Droppable droppableId=\"tiles\">\r\n                                {(provided, snapshot) => (\r\n                                    <div\r\n                                        {...provided.droppableProps}\r\n                                        ref={provided.innerRef}\r\n                                        className={blk('col', ['items'])}\r\n                                    >\r\n                                        {tiles.map((tile, idx) => (\r\n                                            <Draggable key={tile.id} draggableId={tile.id.toString()} index={idx}>\r\n                                                {(innerProvided) => (\r\n                                                    <div\r\n                                                        {...innerProvided.dragHandleProps}\r\n                                                        {...innerProvided.draggableProps}\r\n                                                        ref={innerProvided.innerRef}\r\n                                                        className={blk('item', ['tile'])}\r\n                                                    >\r\n                                                        <div className={blk('thumb')}>\r\n                                                            <SvgCanvas blk={blk}>\r\n                                                                {tile.elements.map(el => <SvgShapeRenderer key={el.id} shape={el} />)}\r\n                                                            </SvgCanvas>\r\n                                                        </div>\r\n                                                        <div className={blk('label')}>\r\n                                                            ID: {tile.id}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )}\r\n                                            </Draggable>\r\n                                        ))}\r\n                                        {provided.placeholder}\r\n                                    </div>\r\n                                )}\r\n                            </Droppable>\r\n                        </div>\r\n                    </div>\r\n                </DragDropContext>\r\n            </Scrollable>\r\n        </FullscreenPageLayout>\r\n    );\r\n}\r\n\r\nexport default Reorder;\r\n","import React from 'react';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport TileEditor from \"./pages/TileEditor\";\nimport Generator from \"./pages/Generator\";\nimport Tiles from \"./pages/Tiles\";\nimport Reorder from \"./pages/Tiles/Reorder\";\n\nfunction App() {\n  return (\n    <Router basename={'/TileMosaicGenerator'}>\n      <Switch>\n        <Route path=\"/tiles/new\">\n          <TileEditor />\n        </Route>\n        <Route path=\"/tiles/reorder\">\n          <Reorder />\n        </Route>\n        <Route path=\"/tiles/:id\">\n            <TileEditor />\n        </Route>\n        <Route path=\"/tiles\">\n            <Tiles />\n        </Route>\n        <Route path=\"/\">\n            <Generator />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {SvgShape} from \"../models/svg\";\r\nimport {\r\n    EDITOR_ADD_SHAPE, EDITOR_CLEAR, EDITOR_DELETE_ELEMENT, EDITOR_ELEM_PROP_CHANGE,\r\n    EDITOR_SELECT_SHAPE,\r\n    EDITOR_SELECT_TOOL, EDITOR_SET_ELEMENTS,\r\n    EDITOR_SET_GRID,\r\n    EditorActions\r\n} from \"../actions/editor\";\r\nimport {Tools} from \"../editor-tools\";\r\n\r\n\r\nexport interface EditorState {\r\n    elements: SvgShape[];\r\n    gridSize: number;\r\n    selectedTool: Tools;\r\n    selectedIdx: number | null;\r\n}\r\n\r\nconst initialState: EditorState = {\r\n    elements: [],\r\n    gridSize: 5,\r\n    selectedTool: Tools.SELECT,\r\n    selectedIdx: null,\r\n}\r\n\r\nexport function editor(state = initialState, action: EditorActions): EditorState {\r\n    switch (action.type) {\r\n        case EDITOR_ADD_SHAPE:\r\n            const newSelected = state.elements.length;\r\n            const elements = [...state.elements, action.shape];\r\n            return {...state, elements, selectedIdx: newSelected};\r\n        case EDITOR_SET_GRID:\r\n            return {...state, gridSize: action.size};\r\n        case EDITOR_SELECT_SHAPE:\r\n            return {...state, selectedIdx: action.idx};\r\n        case EDITOR_SELECT_TOOL:\r\n            return {...state, selectedTool: action.tool};\r\n        case EDITOR_ELEM_PROP_CHANGE:\r\n            return {...state, elements: state.elements.map(\r\n                (s, i) => i === action.elemIdx ? {...s, [action.propName]: action.value} : s\r\n            )}\r\n        case EDITOR_SET_ELEMENTS:\r\n            const newSelectedIdx = state.selectedIdx !== null\r\n                ?\r\n                action.elements.findIndex(el => el.id === state.elements[state.selectedIdx ?? 0].id)\r\n                :\r\n                null;\r\n            return {...state, elements: action.elements, selectedIdx: newSelectedIdx};\r\n        case EDITOR_DELETE_ELEMENT:\r\n            return {...state, elements: state.elements.filter(el => el.id !== action.id)};\r\n        case EDITOR_CLEAR:\r\n            return initialState;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","import {combineReducers, createStore} from \"redux\";\r\nimport { composeWithDevTools } from \"redux-devtools-extension\";\r\nimport {editor} from \"./editor\";\r\nimport {palette} from \"./palette\";\r\nimport {tiles} from \"./tiles\";\r\n\r\nconst rootReducer = combineReducers({\r\n    editor,\r\n    palette,\r\n    tiles,\r\n});\r\n\r\nconst store = createStore(rootReducer,\r\n    composeWithDevTools()\r\n);\r\n\r\nexport type TheState = ReturnType<typeof rootReducer>\r\n\r\nexport default store;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './scss/styles.scss';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from \"./reducers\";\r\nimport { Provider } from 'react-redux';\r\n\r\nimport '@fortawesome/fontawesome-free/js/fontawesome'\r\nimport '@fortawesome/fontawesome-free/js/solid'\r\nimport '@fortawesome/fontawesome-free/js/regular'\r\nimport '@fortawesome/fontawesome-free/js/brands'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n      <Provider store={store}>\r\n          <App />\r\n      </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}